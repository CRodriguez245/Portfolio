<!DOCTYPE html>
<!-- 
    CARLOS'S PORTFOLIO - AI SIDEKICK SETUP
    
    To enable OpenAI-powered AI sidekick:
    1. Get an OpenAI API key from https://platform.openai.com/api-keys
    2. Open browser console (F12) and run:
       localStorage.setItem("openai_api_key", "your-api-key-here")
    3. Reload the page
    
    The AI will automatically use OpenAI if available, otherwise fallback to the rule-based system.
-->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carlos Rodriguez - AI Product Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@500;700&family=Nuosu+SIL&display=swap" rel="stylesheet">
    <style>
        @font-face {
            font-family: 'Helvetica Neue';
            src: url('fonts/HelveticaNeue-Light.woff2') format('woff2');
            font-weight: 300;
        }
        @font-face {
            font-family: 'Helvetica Neue';
            src: url('fonts/HelveticaNeue-Medium.woff2') format('woff2');
            font-weight: 500;
        }
        @font-face {
            font-family: 'Helvetica Neue';
            src: url('fonts/HelveticaNeue-Bold.woff2') format('woff2');
            font-weight: 700;
        }
        .font-helvetica {
            font-family: 'Helvetica Neue', sans-serif;
        }
        .font-nuosu {
            font-family: 'Nuosu SIL', serif;
        }
        .nav-link {
            position: relative;
            text-decoration: none;
        }
        .nav-link::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 1px;
            bottom: -4px;
            left: 0;
            background-color: #000000;
            transform: scaleX(0);
            transform-origin: bottom right;
            transition: transform 0.3s ease;
        }
        
        /* Mobile-specific nav link styling */
        @media (max-width: 768px) {
            .nav-link::after {
                width: auto;
                min-width: 0;
            }
            
            /* Ensure active state shows the line */
            .nav-link.active::after {
                transform: scaleX(1);
                transform-origin: bottom left;
            }
            
            /* Ensure hover state works on mobile */
            .nav-link:hover::after {
                transform: scaleX(1);
                transform-origin: bottom left;
            }
            
            /* Mobile email popup positioning */
            #email-popup {
                bottom: 180px !important;
                right: 16px !important;
                top: auto !important;
            }
        }
        .nav-link:hover::after {
            transform: scaleX(1);
            transform-origin: bottom left;
        }
        .nav-link.active::after {
            transform: scaleX(1);
        }
        .chat-input {
            background: transparent;
            border: none;
            font-family: 'IBM Plex Mono', monospace;
            font-size: 14px;
            width: 100%;
            padding: 0;
            margin: 0;
            outline: none;
        }
        .chat-input::placeholder {
            color: #666;
        }
        .typing-indicator::after {
            content: '';
            animation: blink 1s infinite;
        }
        @keyframes blink {
            50% { opacity: 0; }
        }
        
        /* Ensure line breaks are preserved in chat messages */
        #chat-messages p {
            white-space: pre-line;
        }
        
        /* Hide default cursor on desktop only */
        @media (min-width: 769px) {
            * {
                cursor: none;
            }
        }
        


        /* Custom cursor */
        .cursor {
            width: 12px;
            height: 12px;
            background-color: #5E5E5E;
            border-radius: 50%;
            position: fixed;
            pointer-events: none;
            z-index: 99999;
            transition: transform 0.2s ease, background-color 0.3s ease;
            left: -100px;
            top: -100px;
        }

        /* Cursor hover effect */
        .cursor.hover {
            transform: scale(1.5);
        }

        .cursor.navigating {
            background-color: #18A000;
            transform: scale(1.5);
        }

        /* Exception for text input areas */
        input, textarea {
            cursor: text;
        }

        /* Exception for clickable elements on desktop */
        @media (min-width: 769px) {
            a, button {
                cursor: none;
            }
        }
        

        .contact-dropdown {
            cursor: none;
        }
        .contact-dropdown:hover {
            cursor: none;
        }
        .contact-dropdown + div a {
            cursor: none;
        }
        .scrollbar-hide {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .scrollbar-hide::-webkit-scrollbar {
            display: none;
        }
        
        /* Force sidekick styles */
        #chat-container.collapsed {
            max-height: 0px !important;
            overflow: hidden !important;
        }
        
        #chat-container.expanded {
            max-height: calc(100vh - 200px) !important;
            overflow: visible !important;
        }
        

        
        /* Mobile full-screen sidekick styles */
        @media (max-width: 768px) {
            /* Prevent zoom on mobile input focus */
            #ai-sidekick.mobile-fullscreen input,
            #ai-sidekick.mobile-fullscreen textarea {
                font-size: 16px !important;
                transform: none !important;
            }
            
            /* Mobile collapsed state - small square button */
            #ai-sidekick {
                width: 60px !important;
                height: 60px !important;
                max-width: 60px !important;
                border-radius: 0 !important;
                bottom: 20px !important;
                right: 20px !important;
                margin: 0 !important;
                left: auto !important;
            }
            
            #ai-sidekick #sidekick-button {
                width: 100% !important;
                height: 100% !important;
                padding: 0 !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                border-radius: 0 !important;
            }
            
            #ai-sidekick #sidekick-text {
                font-size: 12px !important;
                font-weight: bold !important;
            }
            
            /* Mobile full-screen mode */
            #ai-sidekick.mobile-fullscreen {
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                right: 0 !important;
                bottom: 0 !important;
                width: 100vw !important;
                height: 100vh !important;
                z-index: 10000 !important;
                background: white !important;
                border-radius: 0 !important;
                margin: 0 !important;
                padding: 0 !important;
                display: flex !important;
                flex-direction: column !important;
                max-width: none !important;
                max-height: none !important;
                transform: none !important;
                /* Safari-specific viewport fixes */
                height: -webkit-fill-available !important;
                min-height: -webkit-fill-available !important;
            }
            
            #ai-sidekick.mobile-fullscreen #chat-container {
                flex: 1 !important;
                display: flex !important;
                flex-direction: column !important;
                padding: 0 !important;
                background: white !important;
                position: relative !important;
                width: 100% !important;
                overflow: hidden !important;
            }
            
            #ai-sidekick.mobile-fullscreen #chat-messages {
                flex: 1 !important;
                padding: 80px 20px 0 20px !important;
                overflow-y: auto !important;
                max-height: none !important;
                width: 100% !important;
                display: flex !important;
                flex-direction: column !important;
                min-height: 0 !important;
                justify-content: flex-end !important;
                margin-top: 60px !important;
                /* Safari-specific fixes */
                -webkit-overflow-scrolling: touch !important;
                -webkit-transform: translateZ(0) !important;
                transform: translateZ(0) !important;
            }
            
            /* Mobile-only: Chat messages display from bottom to top */
            #ai-sidekick.mobile-fullscreen #chat-messages p {
                margin: 0 !important;
                padding: 8px 0 !important;
                flex-shrink: 0 !important;
            }
            
            #ai-sidekick.mobile-fullscreen #chat-input-container {
                position: sticky !important;
                bottom: 0 !important;
                background: white !important;
                padding: 20px !important;
                border-top: 1px solid #e5e7eb !important;
                width: 100% !important;
                flex-shrink: 0 !important;
                /* Safari-specific fixes */
                -webkit-transform: translateZ(0) !important;
                transform: translateZ(0) !important;
            }
            
            #ai-sidekick.mobile-fullscreen #sidekick-button {
                position: fixed !important;
                top: 10px !important;
                right: 10px !important;
                width: 40px !important;
                height: 40px !important;
                padding: 0 !important;
                border-radius: 0 !important;
                background: rgba(255, 255, 255, 0.9) !important;
                z-index: 99999 !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                border: none !important;
                left: auto !important;
                transform: none !important;
                pointer-events: auto !important;
            }
            
            /* White bar to cut off chat log before X button */
            #ai-sidekick.mobile-fullscreen::before {
                content: '' !important;
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                right: 0 !important;
                width: 100% !important;
                height: 60px !important;
                background: white !important;
                z-index: 99998 !important;
                pointer-events: none !important;
            }
            
            #ai-sidekick.mobile-fullscreen #sidekick-text {
                font-size: 24px !important;
                font-weight: bold !important;
                color: #18a000 !important;
                z-index: 99999 !important;
            }
            
            /* Hide main content when sidekick is fullscreen on mobile */
            #main-content.mobile-hidden {
                display: none !important;
            }
            

            

        }
    </style>
</head>
<body class="bg-white">
    <!-- Custom cursor element -->
    <div class="cursor" id="cursor"></div>

    <!-- Main Content Area (responsive width) -->
    <div class="w-full md:w-3/4 overflow-x-hidden transition-all duration-500 ease-in-out" id="main-content">
        <!-- Navigation -->
        <nav class="fixed w-full md:w-3/4 z-50 transition-all duration-500 ease-in-out" id="main-nav">
            <div class="bg-white/80 backdrop-blur-lg px-4 md:px-12 py-4 md:py-6">
                <div class="flex justify-between items-center">
                    <h1 class="text-[20px] md:text-[28px] font-nuosu">Carlos Rodriguez</h1>
                    
                    <!-- Desktop Navigation -->
                    <div class="hidden md:flex space-x-12">
                        <a href="#" class="text-[16px] font-helvetica font-light nav-link active relative">Home</a>
                        <a href="projects.html" class="text-[16px] font-helvetica font-light nav-link relative">Projects</a>
                        <a href="https://docs.google.com/document/d/1RXj2iDbQUYEA5Zh2meN2EXdoaU2CWZfN_qSqDnq9CNY/edit?tab=t.0" target="_blank" class="text-[16px] font-helvetica font-light nav-link relative">Resume</a>
                        <a href="about.html" class="text-[16px] font-helvetica font-light nav-link relative">About</a>
                        <div class="relative group">
                            <button class="text-[16px] font-helvetica font-light nav-link relative contact-dropdown">Contact</button>
                            <div class="absolute top-full right-0 mt-2 opacity-0 invisible group-hover:opacity-100 group-hover:visible contact-dropdown-menu transition-all duration-200 z-[9999]">
                                <div class="relative pr-4">
                                    <div class="bg-white/80 backdrop-blur-sm rounded-sm px-3 py-2">
                                        <div class="space-y-2 text-right">
                                            <p class="text-[14px] font-helvetica font-bold text-black whitespace-nowrap">Let's build something thoughtful.</p>
                                            <div class="space-y-1">
                                                <button onclick="copyEmail()" class="block text-[14px] font-helvetica font-light hover:text-[#18a000] transition-colors text-right w-full">c.a.rodriguez1999@gmail.com</button>
                                                <a href="https://www.linkedin.com/in/carloscoding/" target="_blank" class="block text-[14px] font-helvetica font-light hover:text-[#18a000] transition-colors">LinkedIn</a>
                                                <a href="https://github.com/CRodriguez245" target="_blank" class="block text-[14px] font-helvetica font-light hover:text-[#18a000] transition-colors">GitHub</a>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="absolute top-0 right-0 w-0.5 bg-black h-0 group-hover:h-full transition-all duration-500 ease-out"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Mobile Menu Button -->
                    <button id="mobile-menu-btn" class="md:hidden text-black">
                        <!-- Hamburger Icon -->
                        <svg class="w-6 h-6" id="hamburger-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                        <!-- X Icon -->
                        <svg class="w-6 h-6 hidden" id="x-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                </div>
                
                <!-- Mobile Navigation Menu -->
                <div id="mobile-menu" class="md:hidden hidden mt-4 pt-4 border-t border-gray-200">
                    <div class="flex flex-col space-y-4">
                        <a href="#" class="text-[16px] font-helvetica font-light nav-link active relative">Home</a>
                        <a href="projects.html" class="text-[16px] font-helvetica font-light nav-link relative">Projects</a>
                        <a href="https://docs.google.com/document/d/1RXj2iDbQUYEA5Zh2meN2EXdoaU2CWZfN_qSqDnq9CNY/edit?tab=t.0" target="_blank" class="text-[16px] font-helvetica font-light nav-link relative">Resume</a>
                        <a href="about.html" class="text-[16px] font-helvetica font-light nav-link relative">About</a>
                        <div class="relative" id="mobile-contact-dropdown">
                            <button class="text-[16px] font-helvetica font-light nav-link relative contact-dropdown" onclick="toggleMobileContact()">Contact</button>
                            <div class="mt-2 opacity-0 invisible contact-dropdown-menu transition-all duration-200" id="mobile-contact-menu">
                                <div class="relative pl-2">
                                    <div class="px-3 py-2">
                                        <div class="space-y-2 text-left">
                                            <p class="text-[14px] font-helvetica font-bold text-black whitespace-nowrap">Let's build something thoughtful.</p>
                                            <div class="space-y-1">
                                                <button onclick="copyEmail()" class="block text-[14px] font-helvetica font-light hover:text-[#18a000] transition-colors text-left w-full">c.a.rodriguez1999@gmail.com</button>
                                                <a href="https://www.linkedin.com/in/carloscoding/" target="_blank" class="block text-[14px] font-helvetica font-light hover:text-[#18a000] transition-colors">LinkedIn</a>
                                                <a href="https://github.com/CRodriguez245" target="_blank" class="block text-[14px] font-helvetica font-light hover:text-[#18a000] transition-colors">GitHub</a>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="absolute top-0 left-0 w-0.5 bg-black h-0 transition-all duration-500 ease-out" id="mobile-contact-line"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Content Sections -->
        <div class="max-w-[960px] mx-auto pt-20 md:pt-24 px-4 md:px-12">
            <!-- Hero Section -->
            <section class="mb-8 md:mb-14 relative h-96 md:h-96">
                <div class="mb-8 md:mb-16">
                    <h2 class="text-[24px] md:text-[32px] font-helvetica font-medium leading-tight">I am a human-centered AI Product Manager.</h2>
                    <h3 class="text-[16px] md:text-[20px] font-helvetica font-light leading-tight mt-2 md:mt-4">Designing transformative experiences<br class="md:hidden"> to amplify unheard voices.</h3>
                </div>
                
                <div class="mb-16 md:mb-32">
                    <p class="text-[14px] md:text-[16px] font-helvetica font-light leading-tight text-right">Currently at Northwestern Medicine.</p>
                    <p class="text-[14px] md:text-[16px] font-helvetica font-light leading-tight mt-1 text-right">Previously at Microsoft.</p>
                </div>
                
                <!-- Hero Animation Area -->
                <div class="absolute inset-0 overflow-hidden group" id="hero-animation">
                    <!-- Text Protection Zone (exclude from animation) -->
                    <div class="absolute top-0 left-0 w-full h-32 md:h-48 pointer-events-none"></div>
                    
                    <!-- Hover Zones - Expanded Coverage -->
                    <div class="absolute top-32 left-0 w-1/3 h-1/3 cursor-pointer" data-zone="top-left"></div>
                    <div class="absolute top-32 right-0 w-1/3 h-1/3 cursor-pointer" data-zone="top-right"></div>
                    <div class="absolute bottom-0 left-0 w-1/3 h-1/3 cursor-pointer" data-zone="bottom-left"></div>
                    <div class="absolute bottom-0 right-0 w-1/3 h-1/3 cursor-pointer" data-zone="bottom-right"></div>
                    <div class="absolute top-1/2 left-1/3 w-1/3 h-1/3 cursor-pointer" data-zone="center"></div>
                    
                    <!-- Additional Zones for Full Coverage -->
                    <div class="absolute top-32 left-1/3 w-1/3 h-1/3 cursor-pointer" data-zone="top-center"></div>
                    <div class="absolute bottom-0 left-1/3 w-1/3 h-1/3 cursor-pointer" data-zone="bottom-center"></div>
                    <div class="absolute top-1/2 left-0 w-1/3 h-1/3 cursor-pointer" data-zone="middle-left"></div>
                    <div class="absolute top-1/2 right-0 w-1/3 h-1/3 cursor-pointer" data-zone="middle-right"></div>
                    
                                                                    <!-- Balanced Animation Lines (matching About page) -->
                    <div class="absolute top-72 left-4 w-1/4 h-px bg-[#18A000] transform scale-x-0 transition-transform duration-500 ease-out origin-left" data-animation="line-1"></div>
                    <div class="absolute top-80 left-4 w-px h-1/4 bg-[#18A000] transform scale-y-0 transition-transform duration-400 ease-out origin-top" data-animation="line-2"></div>
                    <div class="absolute top-88 left-8 w-1/6 h-0.5 bg-[#18A000] transform scale-x-0 transition-transform duration-600 ease-out origin-left" data-animation="line-3"></div>
                    <div class="absolute top-96 left-4 w-0.5 h-1/6 bg-[#18A000] transform scale-y-0 transition-transform duration-500 ease-out origin-top" data-animation="line-4"></div>
                    <div class="absolute top-104 left-8 w-1/8 h-px bg-[#18A000] transform scale-x-0 transition-transform duration-700 ease-out origin-left" data-animation="line-5"></div>
                    <div class="absolute top-112 left-4 w-px h-1/8 bg-[#18A000] transform scale-y-0 transition-transform duration-600 ease-out origin-top" data-animation="line-6"></div>
                    <div class="absolute top-120 left-8 w-1/6 h-0.5 bg-[#18A000] transform scale-x-0 transition-transform duration-500 ease-out origin-left" data-animation="line-7"></div>
                    <div class="absolute top-128 left-4 w-0.5 h-1/6 bg-[#18A000] transform scale-y-0 transition-transform duration-700 ease-out origin-top" data-animation="line-8"></div>
                    <div class="absolute top-136 left-8 w-1/4 h-px bg-[#18A000] transform scale-x-0 transition-transform duration-600 ease-out origin-left" data-animation="line-9"></div>
                    <div class="absolute top-144 left-4 w-px h-1/4 bg-[#18A000] transform scale-y-0 transition-transform duration-500 ease-out origin-top" data-animation="line-10"></div>
                    <div class="absolute top-152 left-8 w-1/6 h-0.5 bg-[#18A000] transform scale-x-0 transition-transform duration-700 ease-out origin-left" data-animation="line-11"></div>
                    <div class="absolute top-160 left-4 w-0.5 h-1/6 bg-[#18A000] transform scale-y-0 transition-transform duration-600 ease-out origin-top" data-animation="line-12"></div>
                    
                    <!-- Additional animation lines for extended mobile area -->
                    <div class="absolute top-168 left-8 w-1/4 h-px bg-[#18A000] transform scale-x-0 transition-transform duration-500 ease-out origin-left" data-animation="line-13"></div>
                    <div class="absolute top-176 left-4 w-px h-1/4 bg-[#18A000] transform scale-y-0 transition-transform duration-400 ease-out origin-top" data-animation="line-14"></div>
                    <div class="absolute top-184 left-8 w-1/6 h-0.5 bg-[#18A000] transform scale-x-0 transition-transform duration-600 ease-out origin-left" data-animation="line-15"></div>
                    <div class="absolute top-192 left-4 w-0.5 h-1/6 bg-[#18A000] transform scale-y-0 transition-transform duration-500 ease-out origin-top" data-animation="line-16"></div>
                    <div class="absolute top-200 left-8 w-1/8 h-px bg-[#18A000] transform scale-x-0 transition-transform duration-700 ease-out origin-left" data-animation="line-17"></div>
                    <div class="absolute top-208 left-4 w-px h-1/8 bg-[#18A000] transform scale-y-0 transition-transform duration-600 ease-out origin-top" data-animation="line-18"></div>
                    
                    <!-- Even more animation lines for larger mobile area -->
                    <div class="absolute top-216 left-8 w-1/4 h-px bg-[#18A000] transform scale-x-0 transition-transform duration-500 ease-out origin-left" data-animation="line-19"></div>
                    <div class="absolute top-224 left-4 w-px h-1/4 bg-[#18A000] transform scale-y-0 transition-transform duration-400 ease-out origin-top" data-animation="line-20"></div>
                    <div class="absolute top-232 left-8 w-1/6 h-0.5 bg-[#18A000] transform scale-x-0 transition-transform duration-600 ease-out origin-left" data-animation="line-21"></div>
                    <div class="absolute top-240 left-4 w-0.5 h-1/6 bg-[#18A000] transform scale-y-0 transition-transform duration-500 ease-out origin-top" data-animation="line-22"></div>
                    <div class="absolute top-248 left-8 w-1/8 h-px bg-[#18A000] transform scale-x-0 transition-transform duration-700 ease-out origin-left" data-animation="line-23"></div>
                    <div class="absolute top-256 left-4 w-px h-1/8 bg-[#18A000] transform scale-y-0 transition-transform duration-600 ease-out origin-top" data-animation="line-24"></div>
                    <div class="absolute top-264 left-8 w-1/4 h-px bg-[#18A000] transform scale-x-0 transition-transform duration-500 ease-out origin-left" data-animation="line-25"></div>
                    <div class="absolute top-272 left-4 w-px h-1/4 bg-[#18A000] transform scale-y-0 transition-transform duration-400 ease-out origin-top" data-animation="line-26"></div>
                    <div class="absolute top-280 left-8 w-1/6 h-0.5 bg-[#18A000] transform scale-x-0 transition-transform duration-600 ease-out origin-left" data-animation="line-27"></div>
                    <div class="absolute top-288 left-4 w-0.5 h-1/6 bg-[#18A000] transform scale-y-0 transition-transform duration-500 ease-out origin-top" data-animation="line-28"></div>
                    <div class="absolute top-296 left-8 w-1/8 h-px bg-[#18A000] transform scale-x-0 transition-transform duration-700 ease-out origin-left" data-animation="line-29"></div>
                    <div class="absolute top-304 left-4 w-px h-1/8 bg-[#18A000] transform scale-y-0 transition-transform duration-600 ease-out origin-top" data-animation="line-30"></div>
                </div>
                

            </section>

            <!-- Featured Projects -->
            <section id="projects" class="mb-8 md:mb-14">
                <h2 class="text-[28px] md:text-[36px] font-nuosu mb-4 md:mb-5">Featured Projects</h2>
                <div class="flex flex-col md:flex-row md:space-x-[25px] space-y-4 md:space-y-0 overflow-x-auto pb-4 scrollbar-hide">
                    <div class="flex-shrink-0 w-full md:w-[calc(33.333%-17px)] pt-4 px-2">
                        <a href="ai-research-workbook.html">
                            <div class="overflow-hidden transition-all duration-300 ease-out hover:shadow-2xl hover:scale-105 mb-3">
                                <img src="images/BeyondChat.webp" alt="AI Research Workbook" class="w-full h-64 object-cover">
                            </div>
                            <h3 class="text-[18px] font-helvetica font-bold mb-0">AI Research Workbook</h3>
                            <p class="text-[14px] font-helvetica font-light">Product Manager, Northwestern Medicine</p>
                        </a>
                    </div>
                    <div class="flex-shrink-0 w-full md:w-[calc(33.333%-17px)] pt-4 px-2">
                        <a href="bachelors-microsoft-health.html">
                            <div class="overflow-hidden transition-all duration-300 ease-out hover:shadow-2xl hover:scale-105 mb-3">
                                <img src="images/BMH-ProjectCard copy.jpg" alt="Bachelors in Microsoft Health" class="w-full h-64 object-cover">
                            </div>
                            <h3 class="text-[18px] font-helvetica font-bold mb-0">Bachelors in Microsoft Health</h3>
                            <p class="text-[14px] font-helvetica font-light">Program Manager, Microsoft Corporation</p>
                        </a>
                    </div>
                    <div class="flex-shrink-0 w-full md:w-[calc(33.333%-17px)] pt-4 px-2">
                        <a href="nm-scholars-program.html">
                            <div class="overflow-hidden transition-all duration-300 ease-out hover:shadow-2xl hover:scale-105 mb-3">
                                <img src="images/NM-Scholars-2.jpg" alt="NM Scholars Program" class="w-full h-64 object-cover">
                            </div>
                            <h3 class="text-[18px] font-helvetica font-bold mb-0">NM Scholars Program</h3>
                            <p class="text-[14px] font-helvetica font-light">Design Strategist, Northwestern Medicine</p>
                        </a>
                    </div>
                </div>
            </section>

            <!-- Experience Section -->
            <section id="resume" class="mb-8 md:mb-14">
                <h2 class="text-[28px] md:text-[36px] font-nuosu mb-4 md:mb-5">Experience</h2>
                <div class="max-w-[805px]">
                    <!-- Northwestern Medicine -->
                    <div class="mb-8 md:mb-12">
                        <div class="flex flex-col md:flex-row md:justify-between md:items-center mb-2">
                            <h3 class="text-[18px] md:text-[20px] font-helvetica font-bold">Northwestern Medicine</h3>
                            <span class="text-[14px] md:text-[16px] font-helvetica font-light mt-1 md:mt-0">2025 - Present</span>
                        </div>
                        <div>
                            <div class="mb-6 md:mb-8">
                                <h4 class="text-[16px] md:text-[20px] font-helvetica font-light mb-2">Product Manager <span class="font-light">| AI Research Workbook</span></h4>
                                <p class="text-[14px] md:text-[16px] font-helvetica font-light leading-relaxed">Led research and product development for an AI-supported workbook helping first-gen students conduct academic research with confidence. Integrated GPT-4 into scaffolded modules, balancing automation with pedagogical integrity. Piloted across university partners with evidence-based learning outcomes.</p>
                            </div>
                            <div>
                                <h4 class="text-[16px] md:text-[20px] font-helvetica font-light mb-2">Design Strategist <span class="font-light">| NM Scholars Program</span></h4>
                                <p class="text-[14px] md:text-[16px] font-helvetica font-light leading-relaxed">Redesigned program delivery and student engagement strategies as the program scaled. Clarified mentor roles, introduced student-led APC structures, and created visual tools to support stakeholder alignment and equity-driven learning experiences.</p>
                            </div>
                        </div>
                        <div class="border-b border-gray-300 mt-4"></div>
                    </div>

                    <!-- Illinois Tech -->
                    <div class="mb-8 md:mb-12">
                        <div class="flex flex-col md:flex-row md:justify-between md:items-center mb-2">
                            <h3 class="text-[18px] md:text-[20px] font-helvetica font-bold">Illinois Institute of Technology</h3>
                            <span class="text-[14px] md:text-[16px] font-helvetica font-light mt-1 md:mt-0">2025 - Present</span>
                        </div>
                        <div>
                            <div>
                                <h4 class="text-[16px] md:text-[20px] font-helvetica font-light mb-2">AI Product Manager <span class="font-light">| Decision-Making Agent</span></h4>
                                <p class="text-[14px] md:text-[16px] font-helvetica font-light leading-relaxed">Developed and deployed a GPT-4-powered sidekick that helps students apply structured decision-making frameworks. Scaled to 100+ users across institutions, improving research workflow clarity and confidence.</p>
                            </div>
                        </div>
                        <div class="border-b border-gray-300 mt-4"></div>
                    </div>

                    <!-- Microsoft -->
                    <div class="mb-8 md:mb-12">
                        <div class="flex flex-col md:flex-row md:justify-between md:items-center mb-2">
                            <h3 class="text-[18px] md:text-[20px] font-helvetica font-bold">Microsoft Corporation</h3>
                            <span class="text-[14px] md:text-[16px] font-helvetica font-light mt-1 md:mt-0">2019 - 2023</span>
                        </div>
                        <div>
                            <div class="mb-6 md:mb-8">
                                <h4 class="text-[16px] md:text-[20px] font-helvetica font-light mb-2">Customer Success Manager <span class="font-light">| Healthcare + Microsoft Copilot</span></h4>
                                <p class="text-[14px] md:text-[16px] font-helvetica font-light leading-relaxed">Drove 392% adoption of Microsoft Teams, Viva, and early Microsoft Copilot features in enterprise health accounts. Co-led a 12-week internal bootcamp (Bachelors in Microsoft Health) serving 1K+ employees to upskill in health systems, AI fluency, and patient-centered design.</p>
                            </div>
                            <div class="mb-6 md:mb-8">
                                <h4 class="text-[16px] md:text-[20px] font-helvetica font-light mb-2">Technical Project Manager <span class="font-light">| Azure & Microsoft Teams</span></h4>
                                <p class="text-[14px] md:text-[16px] font-helvetica font-light leading-relaxed">Scrum Master for two cross-functional engineering teams. Improved sprint completion by 48% and built a cross-org dashboard aligning Azure/Teams engineering with executive visibility, cutting backlog by 40%.</p>
                            </div>
                            <div>
                                <h4 class="text-[16px] md:text-[20px] font-helvetica font-light mb-2">Solution Specialist <span class="font-light">| Azure Growth</span></h4>
                                <p class="text-[14px] md:text-[16px] font-helvetica font-light leading-relaxed">Created targeting frameworks and internal enablement strategies that contributed to 14% YoY Azure growth across U.S. health sector partners.</p>
                            </div>
                        </div>
                        <div class="border-b border-gray-300 mt-4"></div>
                    </div>

                    <!-- MyRealFood -->
                    <div class="mb-8 md:mb-12">
                        <div class="flex flex-col md:flex-row md:justify-between md:items-center mb-2">
                            <h3 class="text-[18px] md:text-[20px] font-helvetica font-bold">MyRealFood</h3>
                            <span class="text-[14px] md:text-[16px] font-helvetica font-light mt-1 md:mt-0">2019</span>
                        </div>
                        <div>
                            <div>
                                <h4 class="text-[16px] md:text-[20px] font-helvetica font-light mb-2">Software Engineer</h4>
                                <p class="text-[14px] md:text-[16px] font-helvetica font-light leading-relaxed">Built calendar-based food-logging features for 1M+ users in React Native. Developed backend nutrition tools powering personalized meal plans.</p>
                            </div>
                        </div>
                        <div class="border-b border-gray-300 mt-4"></div>
                    </div>
                </div>
            </section>

            <!-- Blog Section -->
            <section id="blog" class="mb-8 md:mb-14">
                <h2 class="text-[28px] md:text-[36px] font-nuosu mb-4 md:mb-5">Blog</h2>
                <p class="text-[14px] md:text-[16px] font-helvetica font-light leading-relaxed mb-8 md:mb-12">I am the co-founder of <span class="text-[#9a472f]">Better Problems</span>, check us out! Here are some featured articles.</p>
                <div class="flex flex-col md:flex-row md:space-x-[25px] space-y-4 md:space-y-0 overflow-x-auto pb-4 scrollbar-hide">
                    <div class="flex-shrink-0 w-full md:w-[calc(33.333%-17px)] pt-4 px-2">
                        <a href="better-problems.html">
                            <div class="overflow-hidden transition-all duration-300 ease-out hover:shadow-2xl hover:scale-105 mb-3">
                                <img src="images/BP-Card2.jpg" alt="Better Problems" class="w-full h-64 object-cover">
                            </div>
                            <h3 class="text-[18px] font-helvetica font-bold mb-0">Better Problems</h3>
                            <p class="text-[14px] font-helvetica font-light">The Power of Reframing Everyday</p>
                        </a>
                    </div>
                    <div class="flex-shrink-0 w-full md:w-[calc(33.333%-17px)] pt-4 px-2">
                        <a href="ai-beyond-chat.html">
                            <div class="overflow-hidden transition-all duration-300 ease-out hover:shadow-2xl hover:scale-105 mb-3">
                                <img src="images/BeyondChat-copy.jpg" alt="AI Beyond The Chat" class="w-full h-64 object-cover">
                            </div>
                            <h3 class="text-[18px] font-helvetica font-bold mb-0">AI Beyond The Chat</h3>
                            <p class="text-[14px] font-helvetica font-light">Designing AI tools that teach</p>
                        </a>
                    </div>
                    <div class="flex-shrink-0 w-full md:w-[calc(33.333%-17px)] pt-4 px-2">
                        <a href="design-what-you-dont-see.html">
                            <div class="overflow-hidden transition-all duration-300 ease-out hover:shadow-2xl hover:scale-105 mb-3">
                                <img src="images/ST copy.jpg" alt="Design Is What You Don't See" class="w-full h-64 object-cover">
                            </div>
                            <h3 class="text-[18px] font-helvetica font-bold mb-0">Design Is What You Don't See</h3>
                            <p class="text-[14px] font-helvetica font-light">Critical design should linger, not resolve</p>
                        </a>
                    </div>
                    <div class="flex-shrink-0 w-full md:w-[calc(33.333%-17px)] pt-4 px-2">
                        <a href="trust-is-the-product.html">
                            <div class="overflow-hidden transition-all duration-300 ease-out hover:shadow-2xl hover:scale-105 mb-3">
                                <img src="images/PMArticle copy.jpeg" alt="Trust Is The Product" class="w-full h-64 object-cover">
                            </div>
                            <h3 class="text-[18px] font-helvetica font-bold mb-0">Trust Is The Product</h3>
                            <p class="text-[14px] font-helvetica font-light">PMs role in responsible AI</p>
                        </a>
                    </div>
                </div>
            </section>



            <!-- Footer -->
            <footer class="bg-white border-t border-gray-200 mt-12 md:mt-20">
                <div class="max-w-7xl mx-auto px-4 md:px-12 py-6 md:py-8">
                    <div class="hidden md:flex md:flex-row md:justify-between md:items-center space-y-4 md:space-y-0">
                        <div class="flex flex-col md:flex-row md:items-center space-y-4 md:space-y-0 md:space-x-8">
                            <div>
                                <h3 class="text-[18px] md:text-[20px] font-nuosu mb-0">Carlos Rodriguez</h3>
                                <p class="text-[12px] md:text-[14px] font-helvetica font-light text-gray-600">AI Product Manager</p>
                            </div>
                            <div class="hidden md:block border-l border-gray-300 h-12"></div>
                            <div class="hidden md:block">
                                <p class="text-[12px] md:text-[14px] font-helvetica font-light text-gray-600 mb-1">Let's build something thoughtful.</p>
                                <div class="flex space-x-4">
                                    <button onclick="copyEmail()" class="text-[12px] md:text-[14px] font-helvetica font-light text-gray-600 hover:text-[#18a000] transition-colors">Email</button>
                                    <a href="https://www.linkedin.com/in/carloscoding/" target="_blank" class="text-[12px] md:text-[14px] font-helvetica font-light text-gray-600 hover:text-[#18a000] transition-colors">LinkedIn</a>
                                    <a href="https://github.com/CRodriguez245" target="_blank" class="text-[12px] md:text-[14px] font-helvetica font-light text-gray-600 hover:text-[#18a000] transition-colors">GitHub</a>
                                </div>
                            </div>
                        </div>
                        <div class="flex flex-col md:flex-row md:items-center space-y-4 md:space-y-0">
                            <div class="hidden md:block text-center md:text-right">
                                <p class="text-[14px] font-helvetica font-light text-gray-600">© 2025 Carlos Rodriguez</p>
                                <p class="text-[12px] font-helvetica font-light text-gray-500 mt-1">Co-founder of <span class="text-[#9a472f]">Better Problems</span></p>
                                <p class="text-[12px] font-helvetica font-light text-gray-500 mt-1">Powered by Cursor AI, Figma, and GPT</p>
                            </div>
                        </div>
                    </div>
                    <div class="md:hidden flex justify-between items-start mb-4">
                        <div>
                            <h3 class="text-[18px] md:text-[20px] font-nuosu mb-0">Carlos Rodriguez</h3>
                            <p class="text-[12px] md:text-[14px] font-helvetica font-light text-gray-600">AI Product Manager</p>
                        </div>
                        <div class="text-right">
                            <p class="text-[12px] md:text-[14px] font-helvetica font-light text-gray-600 mb-1">Let's build something thoughtful.</p>
                            <div class="flex space-x-4 justify-end">
                                <button onclick="copyEmail()" class="text-[12px] md:text-[14px] font-helvetica font-light text-gray-600 hover:text-[#18a000] transition-colors">Email</button>
                                <a href="https://www.linkedin.com/in/carloscoding/" target="_blank" class="text-[12px] md:text-[14px] font-helvetica font-light text-gray-600 hover:text-[#18a000] transition-colors">LinkedIn</a>
                                <a href="https://github.com/CRodriguez245" target="_blank" class="text-[12px] md:text-[14px] font-helvetica font-light text-gray-600 hover:text-[#18a000] transition-colors">GitHub</a>
                            </div>
                        </div>
                    </div>
                    <div class="md:hidden text-center">
                        <p class="text-[14px] font-helvetica font-light text-gray-600">© 2025 Carlos Rodriguez</p>
                        <p class="text-[12px] font-helvetica font-light text-gray-500 mt-1">Co-founder of <span class="text-[#9a472f]">Better Problems</span></p>
                        <p class="text-[12px] font-helvetica font-light text-gray-500 mt-1">Powered by Cursor AI, Figma, and GPT</p>
                    </div>
                    </div>
                </div>
            </footer>
        </div>
    </div>

    <!-- Email Copy Popup -->
    <div id="email-popup" class="fixed top-4 right-4 md:top-4 md:right-4 text-gray-700 px-3 py-2 font-helvetica text-[12px] z-[10000] transition-all duration-300 ease-in-out" style="display: none; opacity: 0; transform: translateY(-10px);">
        <span>Email copied to clipboard</span>
        <!-- Rolling line animation -->
        <div class="absolute top-0 right-0 w-1 h-full bg-black transform scale-y-0 transition-transform duration-500 ease-out origin-top" id="popup-line"></div>
    </div>

    <!-- AI Sidekick -->
    <div class="fixed bottom-0 right-2 md:right-8 w-[calc(100vw-16px)] md:w-1/4 md:max-w-[394px] flex flex-col z-[9999] transition-all duration-500 ease-in-out" id="ai-sidekick">
        <div class="overflow-hidden transition-all duration-500 ease-in-out" id="chat-container">
            <div class="font-['IBM_Plex_Mono'] text-[14px] space-y-4 mb-4 max-h-[calc(100vh-200px)] overflow-y-auto pr-2" id="chat-messages">
                <p class="text-[#18a000]">Hi! I'm Carlos's AI sidekick. I can navigate you through his portfolio and share insights about his process, values, and strategic thinking. Ask me anything about his projects, experience, or dive deeper into his approach!</p>
            </div>
            <div class="font-['IBM_Plex_Mono'] text-[14px] mb-4 flex" id="chat-input-container">
                <span class="text-black mt-[2px]">></span>
                <div class="relative flex-1 ml-2">
                    <textarea 
                        class="bg-transparent border-none font-['IBM_Plex_Mono'] text-[14px] w-full outline-none text-black resize-none overflow-hidden p-0 leading-normal"
                        placeholder="Ask me anything..."
                        id="chat-input"
                        rows="1"
                        style="height: 20px;"
                    ></textarea>
                </div>
            </div>
            <!-- Debug panel -->
            <div class="debug-panel" id="debugPanel" style="display: none; margin-top: 10px; padding: 10px; background: #f0f0f0; border-radius: 5px; font-family: monospace; font-size: 10px; max-height: 150px; overflow-y: auto; border: 1px solid #ccc;">
                <strong>Debug Logs:</strong>
                <div id="debugLogs"></div>
                <button onclick="clearDebugLogs()" style="margin-top: 5px; padding: 3px 8px; font-size: 10px; background: #666; color: white; border: none; border-radius: 3px;">Clear Logs</button>
                <button onclick="clearContext()" style="margin-top: 5px; padding: 3px 8px; font-size: 10px; background: #444; color: white; border: none; border-radius: 3px;">Clear Context</button>
                <button onclick="alert(localStorage.getItem('sidekickContext'))" style="margin-top: 5px; padding: 3px 8px; font-size: 10px; background: #444; color: white; border: none; border-radius: 3px;">Show Raw Context</button>
                <button onclick="testContext()" style="margin-top: 5px; padding: 3px 8px; font-size: 10px; background: #444; color: white; border: none; border-radius: 3px;">Test Context</button>
                <button onclick="testCursor()" style="margin-top: 5px; padding: 3px 8px; font-size: 10px; background: #666; color: white; border: none; border-radius: 3px;">Test Cursor</button>
                <button onclick="testSidekickExpansion()" style="margin-top: 5px; padding: 3px 8px; font-size: 10px; background: #18a000; color: white; border: none; border-radius: 3px;">Test Sidekick</button>
            </div>
        </div>
        <div class="bg-[#18a000] p-4 cursor-pointer transition-all duration-500 ease-in-out" id="sidekick-button" onclick="toggleSidekick()">
            <h3 class="text-white text-center font-['IBM_Plex_Mono'] font-bold transition-all duration-500 ease-in-out" id="sidekick-text">AI Sidekick</h3>
        </div>
    </div>

            <script src="simple-context-sidekick.js"></script>
        <script src="openai-sidekick.js"></script>
    <script>
        // Initialize Simple Context AI Sidekick
        let simpleSidekick = null;
        
        // Sidekick toggle state
        let sidekickCollapsed = false;
        
        // Track if this is a navigation (not refresh)
        let isNavigation = false;
        
        // Set up beforeunload listener to detect navigation vs refresh
        window.addEventListener('beforeunload', function() {
            // If we're navigating to another page in our site, mark it as navigation
            const currentUrl = window.location.href;
            const nextUrl = sessionStorage.getItem('nextUrl');
            
            if (nextUrl && nextUrl !== currentUrl) {
                isNavigation = true;
                sessionStorage.setItem('isNavigation', 'true');
            }
        });
        
        // Set up click listeners for navigation links
        document.addEventListener('DOMContentLoaded', function() {
            const links = document.querySelectorAll('a[href]');
            links.forEach(link => {
                link.addEventListener('click', function() {
                    const href = this.getAttribute('href');
                    if (href && !href.startsWith('http') && !href.startsWith('#')) {
                        sessionStorage.setItem('nextUrl', window.location.origin + href);
                    }
                });
            });
        });
        
        // Initialize sidekick state from sessionStorage
        function initializeSidekickState() {
            console.log('=== INITIALIZATION DEBUG ===');
            const savedState = sessionStorage.getItem('sidekickCollapsed');
            const wasNavigation = sessionStorage.getItem('isNavigation');
            
            console.log('Initializing sidekick state:', savedState);
            console.log('Was navigation:', wasNavigation);
            
            // Clear the navigation flag
            sessionStorage.removeItem('isNavigation');
            sessionStorage.removeItem('nextUrl');
            
            // Apply collapsed state if it was a navigation and sidekick was collapsed
            if (savedState === 'true' && wasNavigation === 'true') {
                console.log('Applying collapsed state from navigation...');
                // Apply collapsed state on page load
                const aiSidekick = document.getElementById('ai-sidekick');
                const chatContainer = document.getElementById('chat-container');
                const sidekickText = document.getElementById('sidekick-text');
                const mainContent = document.getElementById('main-content');
                
                console.log('Elements found during initialization:', {
                    aiSidekick: !!aiSidekick,
                    chatContainer: !!chatContainer,
                    sidekickText: !!sidekickText,
                    mainContent: !!mainContent
                });
                
                if (aiSidekick && chatContainer && sidekickText && mainContent) {
                    // Set initial collapsed state
                    console.log('Setting collapsed state...');
                    const isMobile = window.innerWidth <= 768;
                    
                    if (isMobile) {
                        // Mobile: Ensure we're not in full-screen mode
                        aiSidekick.classList.remove('mobile-fullscreen');
                        mainContent.classList.remove('mobile-hidden');
                        chatContainer.style.display = 'none';
                        sidekickText.textContent = 'AI';
                    } else {
                        // Desktop: Original collapsed state
                        chatContainer.style.display = 'none';
                        aiSidekick.style.width = '80px';
                        aiSidekick.style.maxWidth = '80px';
                        sidekickText.style.fontSize = '14px';
                        sidekickText.textContent = 'AI';
                        mainContent.style.width = '75%';
                        mainContent.style.marginLeft = '12.5%'; // Center the 75% content
                    }
                    
                    sidekickCollapsed = true;
                    console.log('Applied collapsed state successfully');
                } else {
                    console.error('Some elements not found during initialization');
                }
            } else {
                console.log('Not navigation or no saved state - checking mobile default');
                const isMobile = window.innerWidth <= 768;
                
                if (isMobile) {
                    // Mobile: Start collapsed by default
                    console.log('Mobile detected - starting collapsed by default');
                    const aiSidekick = document.getElementById('ai-sidekick');
                    const chatContainer = document.getElementById('chat-container');
                    const sidekickText = document.getElementById('sidekick-text');
                    const mainContent = document.getElementById('main-content');
                    
                    if (aiSidekick && chatContainer && sidekickText && mainContent) {
                        // Ensure we're not in full-screen mode
                        aiSidekick.classList.remove('mobile-fullscreen');
                        mainContent.classList.remove('mobile-hidden');
                        chatContainer.style.display = 'none';
                        sidekickText.textContent = 'AI';
                        sidekickCollapsed = true;
                        sessionStorage.setItem('sidekickCollapsed', 'true');
                        console.log('Applied mobile collapsed state successfully');
                    }
                } else {
                    // Desktop: Reset to expanded state on refresh, direct access, or external navigation
                    sessionStorage.setItem('sidekickCollapsed', 'false');
                    sidekickCollapsed = false;
                    console.log('Desktop - resetting to expanded state');
                }
            }
            console.log('=== END INITIALIZATION DEBUG ===');
        }
        
        // Toggle AI Sidekick function
        function toggleSidekick() {
            console.log('=== TOGGLE SIDEKICK DEBUG ===');
            console.log('Toggle sidekick called, current state:', sidekickCollapsed);
            
            const aiSidekick = document.getElementById('ai-sidekick');
            const chatContainer = document.getElementById('chat-container');
            const sidekickText = document.getElementById('sidekick-text');
            const mainContent = document.getElementById('main-content');
            const chatInput = document.getElementById('chat-input');
            
            console.log('Elements found:', {
                aiSidekick: !!aiSidekick,
                chatContainer: !!chatContainer,
                sidekickText: !!sidekickText,
                mainContent: !!mainContent,
                chatInput: !!chatInput
            });
            
            // Check if we're on mobile
            const isMobile = window.innerWidth <= 768;
            
            if (sidekickCollapsed) {
                console.log('Expanding sidekick...');
                
                if (isMobile) {
                    // Mobile: Full-screen mode
                    console.log('Mobile: Expanding to full-screen mode');
                    aiSidekick.classList.add('mobile-fullscreen');
                    mainContent.classList.add('mobile-hidden');
                    chatContainer.style.display = 'block';
                    chatContainer.style.visibility = 'visible';
                    chatContainer.style.opacity = '1';
                    sidekickText.textContent = '×';
                    
                    // Ensure input is visible and functional
                    if (chatInput) {
                        chatInput.style.display = 'block';
                        chatInput.style.visibility = 'visible';
                        chatInput.style.opacity = '1';
                        setTimeout(() => {
                            chatInput.focus();
                        }, 100);
                        console.log('Mobile input field restored successfully');
                    }
                } else {
                    // Desktop: Original behavior
                    console.log('Desktop: Expanding to sidebar mode');
                    chatContainer.style.display = 'block';
                    chatContainer.style.visibility = 'visible';
                    chatContainer.style.opacity = '1';
                    chatContainer.style.maxHeight = 'none';
                    chatContainer.style.overflow = 'visible';
                    
                    aiSidekick.style.width = '25%';
                    aiSidekick.style.maxWidth = '394px';
                    sidekickText.style.fontSize = '14px';
                    sidekickText.textContent = 'AI Sidekick';
                    mainContent.style.width = '75%';
                    mainContent.style.marginLeft = '0';
                    
                    // Ensure input is visible and functional
                    if (chatInput) {
                        chatInput.style.display = 'block';
                        chatInput.style.visibility = 'visible';
                        chatInput.style.opacity = '1';
                        chatInput.focus();
                        console.log('Desktop input field restored successfully');
                    }
                }
                
                sidekickCollapsed = false;
                sessionStorage.setItem('sidekickCollapsed', 'false');
                console.log('Sidekick expanded, state saved');
            } else {
                console.log('Collapsing sidekick...');
                
                if (isMobile) {
                    // Mobile: Exit full-screen mode
                    console.log('Mobile: Exiting full-screen mode');
                    aiSidekick.classList.remove('mobile-fullscreen');
                    mainContent.classList.remove('mobile-hidden');
                    chatContainer.style.display = 'none';
                    sidekickText.textContent = 'AI';
                } else {
                    // Desktop: Original collapse behavior
                    console.log('Desktop: Collapsing to sidebar mode');
                    chatContainer.style.display = 'none';
                    aiSidekick.style.width = '80px';
                    aiSidekick.style.maxWidth = '80px';
                    sidekickText.style.fontSize = '14px';
                    sidekickText.textContent = 'AI';
                    mainContent.style.width = '75%';
                    mainContent.style.marginLeft = '12.5%'; // Center the 75% content
                }
                
                sidekickCollapsed = true;
                sessionStorage.setItem('sidekickCollapsed', 'true');
                console.log('Sidekick collapsed, state saved');
            }
            console.log('=== END TOGGLE DEBUG ===');
        }

        // Debug panel functions
        function toggleDebugPanel() {
            const panel = document.getElementById('debugPanel');
            const logs = document.getElementById('debugLogs');
            if (panel.style.display === 'none') {
                panel.style.display = 'block';
                updateDebugLogs();
            } else {
                panel.style.display = 'none';
            }
        }

        function updateDebugLogs() {
            const logs = document.getElementById('debugLogs');
            if (simpleSidekick) {
                logs.textContent = simpleSidekick.getDebugLogs();
            } else {
                logs.textContent = 'Sidekick not initialized';
            }
        }

        function clearDebugLogs() {
            if (simpleSidekick) {
                simpleSidekick.clearDebugLogs();
                updateDebugLogs();
            }
        }

        function clearContext() {
            if (simpleSidekick) {
                simpleSidekick.forceClearContext();
                console.log('Context cleared manually');
            }
        }

        function testContext() {
            if (simpleSidekick) {
                const context = simpleSidekick.getContext();
                alert(JSON.stringify(context, null, 2));
            } else {
                alert('Simple sidekick not initialized.');
            }
        }

        function testCursor() {
            const cursor = document.getElementById('cursor');
            if (cursor) {
                console.log('Testing cursor animation');
                cursor.classList.add('navigating');
                cursor.style.transition = 'all 1s ease';
                cursor.style.left = '100px';
                cursor.style.top = '100px';
                
                setTimeout(() => {
                    cursor.style.left = '200px';
                    cursor.style.top = '200px';
                    
                    setTimeout(() => {
                        cursor.classList.remove('navigating');
                        cursor.style.transition = 'transform 0.2s ease, background-color 0.3s ease';
                    }, 1000);
                }, 1000);
            } else {
                alert('Cursor element not found');
            }
        }

        // Cursor functionality
        const cursor = document.getElementById('cursor');
        let links = document.querySelectorAll('a');
        let buttons = document.querySelectorAll('button');
        let isNavigating = false;
        let lastAINavigationPosition = null; // Track AI's final position

        document.addEventListener('mousemove', (e) => {
            if (!isNavigating && !lastAINavigationPosition) {
                cursor.style.left = e.clientX + 'px';
                cursor.style.top = e.clientY + 'px';
            } else if (!isNavigating && lastAINavigationPosition) {
                // User is moving the mouse after AI navigation - clear stored position
                lastAINavigationPosition = null;
                cursor.style.left = e.clientX + 'px';
                cursor.style.top = e.clientY + 'px';
            }
            // If isNavigating is true, don't update cursor position - let AI control it
        });

        links.forEach(link => {
            link.addEventListener('mouseenter', () => {
                if (!isNavigating && !lastAINavigationPosition) {
                    cursor.classList.add('hover');
                }
            });
            
            link.addEventListener('mouseleave', () => {
                cursor.classList.remove('hover');
            });
        });

        buttons.forEach(button => {
            button.addEventListener('mouseenter', () => {
                if (!isNavigating && !lastAINavigationPosition) {
                    cursor.classList.add('hover');
                }
            });
            
            button.addEventListener('mouseleave', () => {
                cursor.classList.remove('hover');
            });
        });

        document.addEventListener('mouseleave', () => {
            cursor.style.display = 'none';
        });

        document.addEventListener('mouseenter', () => {
            cursor.style.display = 'block';
        });

        // Function to smoothly transition cursor from AI to user control
        function transitionCursorFromAI() {
            if (lastAINavigationPosition) {
                // Keep cursor at AI's final position
                cursor.style.left = lastAINavigationPosition.x + 'px';
                cursor.style.top = lastAINavigationPosition.y + 'px';
            }
            // Set isNavigating to false but keep the stored position
            isNavigating = false;
            // The stored position will be cleared only when user moves the mouse
        }

        // Enhanced responses with navigation capabilities and deeper insights
        const responses = {
            'microsoft': {
                keywords: ['microsoft', 'copilot', 'microsoft health', 'bachelors program', 'big tech', 'big tech company', 'tech company', 'large company', 'enterprise'],
                response: "Carlos worked at Microsoft on their healthcare initiatives! He helped design the Bachelors in Microsoft Health program. What's interesting about his approach is how he balanced enterprise constraints with human-centered design - he often talks about 'designing within the system' rather than against it. He learned to navigate complex stakeholder dynamics while maintaining design integrity. Let me show you that project.",
                action: () => {
                    const cursor = document.getElementById('cursor');
                    const projectsLink = document.querySelector('a[href="projects.html"]');
                    
                    // Set isNavigating to true to prevent mouse tracking interference
                    isNavigating = true;
                    console.log('Microsoft navigation started, isNavigating set to true');
                    
                    cursor.classList.add('navigating');
                    
                    const rect = projectsLink.getBoundingClientRect();
                    cursor.style.transition = 'all 1s ease';
                    cursor.style.left = (rect.left + rect.width/2) + 'px';
                    cursor.style.top = (rect.top + rect.height/2) + 'px';
                    
                    console.log('Cursor positioned at:', rect.left + rect.width/2, rect.top + rect.height/2);
                    
                    setTimeout(() => {
                        // Store the final position before navigation
                        lastAINavigationPosition = {
                            x: rect.left + rect.width/2,
                            y: rect.top + rect.height/2
                        };
                        sessionStorage.setItem('isNavigating', 'true');
                        sessionStorage.setItem('targetProject', 'bachelors-microsoft-health');
                        sessionStorage.setItem('scrollToProject', 'true');
                        console.log('Navigating to Microsoft Health project');
                        window.location.href = 'projects.html';
                    }, 1000);
                }
            },
            'ai': {
                keywords: ['ai', 'artificial intelligence', 'gpt', 'chatgpt', 'ai technologies', 'machine learning', 'ai experience', 'chatgpt', 'gpt', 'openai'],
                response: "Carlos has extensive AI experience! He built an AI Research Workbook at Northwestern Medicine and worked on Microsoft Copilot integration. What's fascinating is his philosophy on AI - he believes in 'human-centered AI' where technology amplifies human judgment rather than replaces it. He often says his goal is to make AI feel more human, not less. His approach focuses on designing AI tools that build user confidence and agency. Let me show you his AI Research Workbook project.",
                action: () => {
                    // Set context for AI Research Workbook
                    if (simpleSidekick) {
                        simpleSidekick.setContext('ai research workbook', "Carlos built an AI Research Workbook at Northwestern Medicine for AI research documentation and collaboration.");
                    }
                    
                    const cursor = document.getElementById('cursor');
                    const projectsLink = document.querySelector('a[href="projects.html"]');
                    
                    // Set isNavigating to true to prevent mouse tracking interference
                    isNavigating = true;
                    console.log('AI navigation started, isNavigating set to true');
                    
                    cursor.classList.add('navigating');
                    
                    const rect = projectsLink.getBoundingClientRect();
                    cursor.style.transition = 'all 1s ease';
                    cursor.style.left = (rect.left + rect.width/2) + 'px';
                    cursor.style.top = (rect.top + rect.height/2) + 'px';
                    
                    console.log('Cursor positioned at:', rect.left + rect.width/2, rect.top + rect.height/2);
                    
                    setTimeout(() => {
                        // Store the final position before navigation
                        lastAINavigationPosition = {
                            x: rect.left + rect.width/2,
                            y: rect.top + rect.height/2
                        };
                        sessionStorage.setItem('isNavigating', 'true');
                        sessionStorage.setItem('targetProject', 'ai-research-workbook');
                        sessionStorage.setItem('scrollToProject', 'true');
                        console.log('Navigating to AI Research Workbook project');
                        window.location.href = 'projects.html';
                    }, 1000);
                }
            },
            'northwestern': {
                keywords: ['northwestern', 'northwestern medicine', 'nm scholars', 'ai research workbook', 'last project', 'recent work', 'latest project'],
                response: "I'll show you his Northwestern Medicine projects! He has two major projects there - the AI Research Workbook and the NM Scholars Program. What's really interesting about his Northwestern work is how he thinks about 'equity by design.' He believes that truly inclusive design means building systems that work for the most vulnerable users first, not as an afterthought. His process involves deep stakeholder engagement with communities that are often left out of innovation conversations. Let me show you his most recent work.",
                action: () => {
                    // Set context for Northwestern Medicine projects (only for Simple Context sidekick)
                    if (simpleSidekick && !(simpleSidekick instanceof OpenAISidekick)) {
                        simpleSidekick.setContext('northwestern medicine', "Carlos has two major projects at Northwestern Medicine - the AI Research Workbook and the NM Scholars Program. Both showcase his ability to bridge AI technology with healthcare needs.");
                        console.log('Context set before navigation');
                    }
                    
                    const cursor = document.getElementById('cursor');
                    const projectsLink = document.querySelector('a[href="projects.html"]');
                    
                    // Set isNavigating to true to prevent mouse tracking interference
                    isNavigating = true;
                    console.log('Northwestern navigation started, isNavigating set to true');
                    
                    cursor.classList.add('navigating');
                    
                    const rect = projectsLink.getBoundingClientRect();
                    cursor.style.transition = 'all 1s ease';
                    cursor.style.left = (rect.left + rect.width/2) + 'px';
                    cursor.style.top = (rect.top + rect.height/2) + 'px';
                    
                    console.log('Cursor positioned at:', rect.left + rect.width/2, rect.top + rect.height/2);
                    
                    setTimeout(() => {
                        // Store the final position before navigation
                        lastAINavigationPosition = {
                            x: rect.left + rect.width/2,
                            y: rect.top + rect.height/2
                        };
                        sessionStorage.setItem('isNavigating', 'true');
                        sessionStorage.setItem('targetProject', 'ai-research-workbook');
                        sessionStorage.setItem('scrollToProject', 'true');
                        
                        // Context is automatically maintained by RAG sidekick
                        console.log('Navigating with context preserved');
                        
                        window.location.href = 'projects.html';
                    }, 1000);
                }
            },
            'healthcare': {
                keywords: ['healthcare', 'medical', 'clinical', 'health', 'medicine', 'healthcare experience'],
                response: "Carlos has significant healthcare experience! He worked at Northwestern Medicine on clinical learning programs and AI research tools. What's unique about his healthcare approach is his focus on 'systemic empathy' - he designs for the entire care ecosystem, not just individual touchpoints. He believes that healthcare innovation should reduce cognitive load for clinicians while improving patient outcomes. His work often involves mapping complex clinical workflows and identifying moments where technology can provide meaningful support. Let me show you his NM Scholars Program.",
                action: () => {
                    // Set context for NM Scholars Program (only for Simple Context sidekick)
                    if (simpleSidekick && !(simpleSidekick instanceof OpenAISidekick)) {
                        simpleSidekick.setContext('nm scholars', "Carlos worked on the NM Scholars Program at Northwestern Medicine, an innovative educational initiative for medical students.");
                    }
                    
                    const cursor = document.getElementById('cursor');
                    const projectsLink = document.querySelector('a[href="projects.html"]');
                    
                    // Set isNavigating to true to prevent mouse tracking interference
                    isNavigating = true;
                    console.log('Healthcare navigation started, isNavigating set to true');
                    
                    cursor.classList.add('navigating');
                    
                    const rect = projectsLink.getBoundingClientRect();
                    cursor.style.transition = 'all 1s ease';
                    cursor.style.left = (rect.left + rect.width/2) + 'px';
                    cursor.style.top = (rect.top + rect.height/2) + 'px';
                    
                    console.log('Cursor positioned at:', rect.left + rect.width/2, rect.top + rect.height/2);
                    
                    setTimeout(() => {
                        // Store the final position before navigation
                        lastAINavigationPosition = {
                            x: rect.left + rect.width/2,
                            y: rect.top + rect.height/2
                        };
                        sessionStorage.setItem('isNavigating', 'true');
                        sessionStorage.setItem('targetProject', 'nm-scholars-program');
                        sessionStorage.setItem('scrollToProject', 'true');
                        console.log('Navigating to NM Scholars Program project');
                        window.location.href = 'projects.html';
                    }, 1000);
                }
            },
            'home': {
                keywords: ['home', 'main page', 'go back', 'return', 'landing page'],
                response: "Let me take you back to the home page!",
                action: () => {
                    const cursor = document.getElementById('cursor');
                    const homeLink = document.querySelector('a[href="index.html"]');
                    cursor.classList.add('navigating');
                    const rect = homeLink.getBoundingClientRect();
                    cursor.style.transition = 'all 1s ease';
                    cursor.style.left = (rect.left + rect.width/2) + 'px';
                    cursor.style.top = (rect.top + rect.height/2) + 'px';
                    setTimeout(() => {
                        // Store the final position before navigation
                        lastAINavigationPosition = {
                            x: rect.left + rect.width/2,
                            y: rect.top + rect.height/2
                        };
                        sessionStorage.setItem('isNavigating', 'true');
                        window.location.href = 'index.html';
                    }, 1000);
                }
            },
            'projects': {
                keywords: ['projects', 'work', 'portfolio', 'case studies', 'what has he built', 'show me his work'],
                response: "I'll take you to his projects page where you can see all his detailed work!",
                action: () => {
                    const cursor = document.getElementById('cursor');
                    const projectsLink = document.querySelector('a[href="projects.html"]');
                    
                    // Set isNavigating to true to prevent mouse tracking interference
                    isNavigating = true;
                    console.log('Projects navigation started, isNavigating set to true');
                    
                    cursor.classList.add('navigating');
                    
                    const rect = projectsLink.getBoundingClientRect();
                    cursor.style.transition = 'all 1s ease';
                    cursor.style.left = (rect.left + rect.width/2) + 'px';
                    cursor.style.top = (rect.top + rect.height/2) + 'px';
                    
                    console.log('Cursor positioned at:', rect.left + rect.width/2, rect.top + rect.height/2);
                    
                    setTimeout(() => {
                        // Store the final position before navigation
                        lastAINavigationPosition = {
                            x: rect.left + rect.width/2,
                            y: rect.top + rect.height/2
                        };
                        sessionStorage.setItem('isNavigating', 'true');
                        console.log('Navigating to projects.html');
                        window.location.href = 'projects.html';
                    }, 1000);
                }
            },
            'experience': {
                keywords: ['experience', 'work history', 'jobs', 'career', 'background', 'what has he done'],
                response: "Let me show you his experience! You can see his work history on the home page or explore his specific projects. What's interesting about his career path is how he's consistently worked at the intersection of technology, design, and social impact. He's moved from technical roles to strategic design, always maintaining a focus on how systems can better serve people. His experience spans from hands-on development to strategic consulting, giving him a unique perspective on both implementation and vision.",
                action: () => {
                    const cursor = document.getElementById('cursor');
                    const homeLink = document.querySelector('a[href="index.html"]');
                    
                    cursor.classList.add('navigating');
                    
                    const rect = homeLink.getBoundingClientRect();
                    cursor.style.transition = 'all 1s ease';
                    cursor.style.left = (rect.left + rect.width/2) + 'px';
                    cursor.style.top = (rect.top + rect.height/2) + 'px';
                    
                    setTimeout(() => {
                        // Store the final position before navigation
                        lastAINavigationPosition = {
                            x: rect.left + rect.width/2,
                            y: rect.top + rect.height/2
                        };
                        sessionStorage.setItem('isNavigating', 'true');
                        window.location.href = 'index.html#resume';
                    }, 1000);
                }
            },
            'about': {
                keywords: ['about', 'who is', 'tell me about', 'background', 'who is carlos'],
                response: "Let me show you more about Carlos!",
                action: () => {
                    const cursor = document.getElementById('cursor');
                    const aboutLink = document.querySelector('a[href="about.html"]');
                    
                    // Set isNavigating to true to prevent mouse tracking interference
                    isNavigating = true;
                    console.log('About navigation started, isNavigating set to true');
                    
                    cursor.classList.add('navigating');
                    const rect = aboutLink.getBoundingClientRect();
                    cursor.style.transition = 'all 1s ease';
                    cursor.style.left = (rect.left + rect.width/2) + 'px';
                    cursor.style.top = (rect.top + rect.height/2) + 'px';
                    
                    console.log('Cursor positioned at:', rect.left + rect.width/2, rect.top + rect.height/2);
                    
                    setTimeout(() => {
                        // Store the final position before navigation
                        lastAINavigationPosition = {
                            x: rect.left + rect.width/2,
                            y: rect.top + rect.height/2
                        };
                        sessionStorage.setItem('isNavigating', 'true');
                        console.log('Navigating to about.html');
                        window.location.href = 'about.html';
                    }, 1000);
                }
            },
            'contact': {
                keywords: ['contact', 'reach', 'email', 'connect', 'get in touch', 'how to contact'],
                response: "I'll show you his contact information! You can find his email, LinkedIn, and GitHub in the contact dropdown.",
                action: () => {
                    const cursor = document.getElementById('cursor');
                    const contactButton = document.querySelector('.contact-dropdown');
                    const contactDropdownMenu = document.querySelector('.contact-dropdown-menu');
                    
                    cursor.classList.add('navigating');
                    
                    // Move cursor to contact button
                    const rect = contactButton.getBoundingClientRect();
                    cursor.style.transition = 'all 1s ease';
                    cursor.style.left = (rect.left + rect.width/2) + 'px';
                    cursor.style.top = (rect.top + rect.height/2) + 'px';
                    
                    setTimeout(() => {
                        // Store the final position before showing dropdown
                        lastAINavigationPosition = {
                            x: rect.left + rect.width/2,
                            y: rect.top + rect.height/2
                        };
                        
                        // Show the dropdown
                        contactDropdownMenu.classList.remove('invisible', 'opacity-0');
                        contactDropdownMenu.classList.add('opacity-100', 'visible');
                        
                        setTimeout(() => {
                            cursor.style.transition = 'transform 0.2s ease, background-color 0.3s ease';
                            cursor.classList.remove('navigating');
                            transitionCursorFromAI(); // Use smooth transition
                        }, 500);
                    }, 1000);
                }
            },
            'resume': {
                keywords: ['resume', 'cv', 'experience', 'work history', 'download resume'],
                response: "I'll open his resume for you! It's a Google Docs link with his full experience and background.",
                action: () => {
                    const cursor = document.getElementById('cursor');
                    const resumeLink = document.querySelector('a[href*="docs.google.com"]');
                    cursor.classList.add('navigating');
                    const rect = resumeLink.getBoundingClientRect();
                    cursor.style.transition = 'all 1s ease';
                    cursor.style.left = (rect.left + rect.width/2) + 'px';
                    cursor.style.top = (rect.top + rect.height/2) + 'px';
                    setTimeout(() => {
                        // Store the final position before clicking
                        lastAINavigationPosition = {
                            x: rect.left + rect.width/2,
                            y: rect.top + rect.height/2
                        };
                        resumeLink.click();
                        setTimeout(() => {
                            cursor.style.transition = 'transform 0.2s ease, background-color 0.3s ease';
                            cursor.classList.remove('navigating');
                            transitionCursorFromAI(); // Use smooth transition
                        }, 100);
                    }, 1000);
                }
            },
            'oldest': {
                keywords: ['oldest', 'older', 'oldest project', 'older project', 'first project', 'earliest project', 'microsoft health'],
                response: "I'll show you his oldest project - the Microsoft Health Bachelors program! This was his first major project where he learned to balance enterprise constraints with human-centered design.",
                action: () => {
                    // Set context for Microsoft Health project (only for Simple Context sidekick)
                    if (simpleSidekick && !(simpleSidekick instanceof OpenAISidekick)) {
                        simpleSidekick.setContext('microsoft health', "Carlos worked on the Bachelors in Microsoft Health program, his oldest project where he learned to balance enterprise constraints with human-centered design.");
                    }
                    
                    const cursor = document.getElementById('cursor');
                    const projectsLink = document.querySelector('a[href="projects.html"]');
                    
                    // Set isNavigating to true to prevent mouse tracking interference
                    isNavigating = true;
                    console.log('Oldest project navigation started, isNavigating set to true');
                    
                    cursor.classList.add('navigating');
                    
                    const rect = projectsLink.getBoundingClientRect();
                    cursor.style.transition = 'all 1s ease';
                    cursor.style.left = (rect.left + rect.width/2) + 'px';
                    cursor.style.top = (rect.top + rect.height/2) + 'px';
                    
                    console.log('Cursor positioned at:', rect.left + rect.width/2, rect.top + rect.height/2);
                    
                    setTimeout(() => {
                        // Store the final position before navigation
                        lastAINavigationPosition = {
                            x: rect.left + rect.width/2,
                            y: rect.top + rect.height/2
                        };
                        sessionStorage.setItem('isNavigating', 'true');
                        sessionStorage.setItem('targetProject', 'bachelors-microsoft-health');
                        sessionStorage.setItem('scrollToProject', 'true');
                        
                        console.log('Navigating to oldest project (Microsoft Health)');
                        
                        window.location.href = 'projects.html';
                    }, 1000);
                }
            },
            'blog': {
                keywords: ['blog', 'blog posts', 'articles', 'writing', 'blog section'],
                response: "I'll take you to his blog section on the homepage where you can read his latest articles and insights!",
                action: () => {
                    const cursor = document.getElementById('cursor');
                    console.log('Blog navigation started');
                    
                    // If we're not on the homepage, navigate there first
                    if (window.location.pathname !== '/index.html' && window.location.pathname !== '/' && !window.location.pathname.endsWith('index.html')) {
                        console.log('Not on homepage, navigating to index.html');
                        sessionStorage.setItem('scrollToSection', 'blog');
                        window.location.href = 'index.html';
                    } else {
                        // We're already on the homepage, animate cursor to blog section
                        console.log('On homepage, animating cursor to blog section');
                        const blogSection = document.querySelector('#blog');
                        if (blogSection) {
                            console.log('Blog section found, starting animation');
                            const rect = blogSection.getBoundingClientRect();
                            
                            // Set isNavigating to true to prevent mouse tracking interference
                            isNavigating = true;
                            
                            // Make cursor visible and start animation
                            cursor.classList.add('navigating');
                            cursor.style.transition = 'all 1s ease';
                            cursor.style.left = (rect.left + rect.width/2) + 'px';
                            cursor.style.top = (rect.top + rect.height/2) + 'px';
                            
                            console.log('Cursor positioned at:', rect.left + rect.width/2, rect.top + rect.height/2);
                            
                            setTimeout(() => {
                                console.log('Starting scroll animation');
                                lastAINavigationPosition = { x: rect.left + rect.width/2, y: rect.top + rect.height/2 };
                                blogSection.scrollIntoView({ behavior: 'smooth' });
                                
                                setTimeout(() => {
                                    console.log('Animation complete, transitioning cursor');
                                    cursor.style.transition = 'transform 0.2s ease, background-color 0.3s ease';
                                    cursor.classList.remove('navigating');
                                    transitionCursorFromAI();
                                }, 1000);
                            }, 1000);
                        } else {
                            console.log('Blog section not found');
                        }
                    }
                }
            },
            'epicac': {
                keywords: ['epicac', 'thermal printer', 'poems', 'vonnegut'],
                response: "Taking you to EPICAC...",
                action: () => {
                    sessionStorage.setItem('isNavigating', 'true');
                    window.location.href = 'epicac.html';
                }
            },
            'gavno': {
                keywords: ['gavno', 'ga.v.no', 'radio', 'brazilian'],
                response: "Taking you to GA.V.NO...",
                action: () => {
                    sessionStorage.setItem('isNavigating', 'true');
                    window.location.href = 'gavno.html';
                }
            },
            'better_problems_project': {
                keywords: ['better problems project', 'independent practice', 'consultancy page'],
                response: "Opening Better Problems (project)...",
                action: () => {
                    sessionStorage.setItem('isNavigating', 'true');
                    window.location.href = 'better-problems-project.html';
                }
            },
            'article_better_problems': {
                keywords: ['better problems article', 'better problems essay'],
                response: "Opening the Better Problems article...",
                action: () => {
                    sessionStorage.setItem('isNavigating', 'true');
                    sessionStorage.setItem('targetProject', 'better-problems');
                    window.location.href = 'index.html';
                }
            },
            'article_ai_beyond_chat': {
                keywords: ['ai beyond the chat', 'beyond chat article'],
                response: "Opening AI Beyond the Chat...",
                action: () => {
                    sessionStorage.setItem('isNavigating', 'true');
                    window.location.href = 'ai-beyond-chat.html';
                }
            },
            'article_design_not_see': {
                keywords: ["design is what you don't see", 'design what you dont see', 'design is what you dont see'],
                response: "Opening Design Is What You Don't See...",
                action: () => {
                    sessionStorage.setItem('isNavigating', 'true');
                    window.location.href = 'design-what-you-dont-see.html';
                }
            },
            'article_trust_product': {
                keywords: ['trust is the product', 'trust is the product article', 'pm role in responsible ai'],
                response: "Opening Trust Is The Product...",
                action: () => {
                    sessionStorage.setItem('isNavigating', 'true');
                    window.location.href = 'trust-is-the-product.html';
                }
            },
            'cursor': {
                keywords: ['cursor', 'cursor ai', 'code editor', 'development tools', 'tools', 'software'],
                response: "Yes, Carlos definitely uses Cursor! It's one of his primary development tools. He uses Cursor AI as his main code editor for rapid development and prototyping. It's listed as one of the tools he used in his AI Research Workbook project at Northwestern Medicine, and it's also mentioned in the footer of his portfolio as one of the technologies powering this site. Carlos values Cursor for its AI-powered development capabilities, which aligns with his philosophy of using AI to amplify human capabilities rather than replace them.",
                action: null
            }
        };

        async function findResponse(input) {
            const lowercaseInput = input.toLowerCase();
            console.log('findResponse called with:', input);
            
            // FIRST: Check if this is a context continuation (prioritize context over navigation)
            if (simpleSidekick) {
                console.log('Checking for context continuation first...');
                
                // Check if this looks like a context continuation
                const contextContinuationPhrases = ['tell me more about it', 'tell me more', 'more about it', 'more details', 'what else', 'continue', 'go on', 'elaborate', 'explain more', 'more', 'it'];
                const isContextContinuation = contextContinuationPhrases.some(phrase => lowercaseInput.includes(phrase));
                
                if (isContextContinuation) {
                    console.log('Context continuation detected, using sidekick response');
                    
                    // Handle async OpenAI sidekick
                    if (simpleSidekick instanceof OpenAISidekick) {
                        const response = await simpleSidekick.getResponse(input);
                        return response;
                    } else {
                        const simpleResponse = simpleSidekick.getResponse(input);
                        
                        // Update debug logs if panel is visible
                        if (document.getElementById('debugPanel').style.display !== 'none') {
                            updateDebugLogs();
                        }
                        
                        return {
                            text: simpleResponse,
                            action: null
                        };
                    }
                }
            }
            
            // SECOND: Check for navigation keywords (but exclude context continuation phrases)
            const contextContinuationPhrases = ['tell me more about it', 'tell me more', 'more about it', 'more details', 'what else', 'continue', 'go on', 'elaborate', 'explain more', 'more', 'it'];
            const navigationKeywords = ['take me', 'go to', 'show me', 'navigate', 'latest', 'recent', 'project', 'projects', 'about', 'home', 'contact', 'resume'];
            
            // Only check navigation if it's NOT a context continuation
            const isContextContinuation = contextContinuationPhrases.some(phrase => lowercaseInput.includes(phrase));
            const isNavigationQuery = !isContextContinuation && navigationKeywords.some(keyword => lowercaseInput.includes(keyword));
            
            if (isNavigationQuery) {
                console.log('Navigation query detected, checking navigation responses first');
                // Check navigation responses first for navigation queries
                for (const category in responses) {
                    if (responses[category].keywords.some(keyword => lowercaseInput.includes(keyword))) {
                        console.log('Found navigation response for:', category);
                        
                        // Update context for navigation responses (only for Simple Context sidekick)
                        if (simpleSidekick && responses[category].response && !(simpleSidekick instanceof OpenAISidekick)) {
                            // Extract topic from the navigation response
                            const topic = simpleSidekick.extractTopicFromResponse(responses[category].response);
                            if (topic) {
                                console.log('Updating context for navigation response:', topic);
                                simpleSidekick.setContext(topic, responses[category].response);
                            }
                        }
                        
                        return {
                            text: responses[category].response,
                            action: responses[category].action
                        };
                    }
                }
                
                // If no navigation response found, don't fall through to OpenAI for navigation queries
                console.log('No navigation response found, but this is a navigation query - not using OpenAI');
                return {
                    text: "I can help you navigate to Carlos's projects! Try asking me to 'take me to the Northwestern Medicine projects' or 'show me the AI Research Workbook'.",
                    action: null
                };
            }
            
            // THIRD: Try the AI sidekick for insight queries
            console.log('=== MAIN RESPONSE DEBUG ===');
            console.log('Input:', input);
            console.log('AI sidekick available?', !!simpleSidekick);
            
            if (simpleSidekick) {
                console.log('AI sidekick object:', simpleSidekick);
                
                // Handle async OpenAI sidekick
                if (simpleSidekick instanceof OpenAISidekick) {
                    console.log('Using OpenAI sidekick');
                    const response = await simpleSidekick.getResponse(input);
                    console.log('OpenAI response:', response);
                    return response;
                } else {
                    // Handle Simple Context sidekick
                    console.log('Using Simple Context sidekick');
                    const simpleResponse = simpleSidekick.getResponse(input);
                    console.log('Simple response:', simpleResponse);
                    
                    // Update debug logs if panel is visible
                    if (document.getElementById('debugPanel').style.display !== 'none') {
                        updateDebugLogs();
                    }
                    
                    // Check if we got a meaningful response (not the default)
                    const defaultResponse = simpleSidekick.getDefaultResponse();
                    console.log('Default response:', defaultResponse);
                    console.log('Response matches default?', simpleResponse === defaultResponse);
                    
                    if (simpleResponse && simpleResponse !== defaultResponse) {
                        console.log('Using simple response');
                        console.log('=== END MAIN DEBUG ===');
                        return {
                            text: simpleResponse,
                            action: null
                        };
                    } else {
                        console.log('Simple response was default, falling back to navigation');
                        console.log('This means the sidekick returned the default response, so navigation will be used');
                    }
                }
            } else {
                console.log('AI sidekick not available');
            }
            console.log('=== END MAIN DEBUG ===');
            
            // Fall back to navigation responses
            for (const category in responses) {
                if (responses[category].keywords.some(keyword => lowercaseInput.includes(keyword))) {
                    return {
                        text: responses[category].response,
                        action: responses[category].action
                    };
                }
            }
            
            // If no exact match, provide a helpful response
            return {
                text: "I can help you navigate through Carlos's portfolio and share insights about his process, values, and strategic thinking! Try asking about his projects, experience, AI work, healthcare experience, Northwestern Medicine projects, or dive deeper into his process, values, strategy, collaboration style, or innovation approach. What would you like to explore?",
                action: null
            };
        }

        // AI Sidekick functionality
        const chatMessages = document.getElementById('chat-messages');
        const chatInput = document.getElementById('chat-input');
        let isTyping = false;

        // Auto-resize textarea
        function autoResize() {
            chatInput.style.height = 'auto';
            chatInput.style.height = chatInput.scrollHeight + 'px';
        }

        chatInput.addEventListener('input', autoResize);

        // Load chat history from sessionStorage
        function loadChatHistory() {
            const history = JSON.parse(sessionStorage.getItem('chatHistory')) || [];
            chatMessages.innerHTML = '';
            if (history.length === 0) {
                addMessage("Hi! I'm Carlos's AI sidekick. I can navigate you through his portfolio and share insights about his process, values, and strategic thinking. Ask me anything about his projects, experience, or dive deeper into his approach!", false);
            } else {
                history.forEach(msg => {
                    const p = document.createElement('p');
                    p.className = msg.isUser ? 'text-black' : 'text-[#18a000]';
                    if (msg.isUser) {
                        p.textContent = `> ${msg.text}`;
                    } else {
                        // Convert line breaks to HTML br tags for proper formatting
                        p.innerHTML = msg.text.replace(/\n/g, '<br>');
                    }
                    chatMessages.appendChild(p);
                });
            }
        }

        // Session tracking for chat history management
        function initializeSession() {
            const isFreshSession = !sessionStorage.getItem('sessionActive');
            const isAINavigation = sessionStorage.getItem('isNavigating') === 'true';
            const referrer = document.referrer;
            const isInternalNavigation = referrer && (
                referrer.includes('index.html') ||
                referrer.includes('projects.html') ||
                referrer.includes('about.html') ||
                referrer.includes('ai-research-workbook.html') ||
                referrer.includes('bachelors-microsoft-health.html') ||
                referrer.includes('nm-scholars-program.html')
            );
            
            // Check if this is a page refresh by looking at performance navigation type
            const isPageRefresh = performance.navigation.type === 1 || 
                                (performance.getEntriesByType('navigation')[0] && 
                                 performance.getEntriesByType('navigation')[0].type === 'reload');

            // Clear chat history if it's a fresh session (page refresh or direct access)
            // Preserve chat history during any internal navigation (AI or manual)
            if ((isFreshSession && !isInternalNavigation && !isAINavigation) || isPageRefresh) {
                sessionStorage.removeItem('chatHistory');
                sessionStorage.setItem('sessionActive', 'true');
            }
        }

        // Load chat history when page loads
        initializeSession();
        loadChatHistory();
        
        // Initialize sidekick state from sessionStorage after DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, initializing sidekick state...');
            initializeSidekickState();
        });

        // Initialize AI Sidekick (OpenAI if available, fallback to Simple Context)
        console.log('=== INITIALIZATION DEBUG ===');
        
        // Check if OpenAI API key is available
        const openaiApiKey = localStorage.getItem('openai_api_key');
        
        if (openaiApiKey) {
            console.log('Using OpenAI sidekick');
            simpleSidekick = new OpenAISidekick(openaiApiKey);
        } else {
            console.log('Using Simple Context sidekick (fallback)');
            console.log('To use OpenAI, set your API key with: localStorage.setItem("openai_api_key", "your-api-key-here")');
            simpleSidekick = new SimpleContextSidekick();
        }
        
        // Helper function to set OpenAI API key (for easy testing)
        window.setOpenAIKey = function(apiKey) {
            localStorage.setItem('openai_api_key', apiKey);
            console.log('OpenAI API key set. Reload the page to use the new AI sidekick.');
        };
        
        // Test function for debugging sidekick expansion
        window.testSidekickExpansion = function() {
            console.log('=== MANUAL TEST ===');
            console.log('Current sidekickCollapsed state:', sidekickCollapsed);
            console.log('Session storage value:', sessionStorage.getItem('sidekickCollapsed'));
            
            const aiSidekick = document.getElementById('ai-sidekick');
            const chatContainer = document.getElementById('chat-container');
            const sidekickText = document.getElementById('sidekick-text');
            const mainContent = document.getElementById('main-content');
            const chatInput = document.getElementById('chat-input');
            
            console.log('All elements found:', {
                aiSidekick: !!aiSidekick,
                chatContainer: !!chatContainer,
                sidekickText: !!sidekickText,
                mainContent: !!mainContent,
                chatInput: !!chatInput
            });
            
            if (chatContainer) {
                console.log('Chat container current styles:', {
                    maxHeight: chatContainer.style.maxHeight,
                    overflow: chatContainer.style.overflow,
                    transition: chatContainer.style.transition
                });
            }
            
            // Try to force expand
            if (sidekickCollapsed && chatContainer) {
                console.log('Attempting to force expand...');
                chatContainer.style.display = 'block';
                chatContainer.style.visibility = 'visible';
                chatContainer.style.opacity = '1';
                sidekickCollapsed = false;
                console.log('Force expand completed');
            }
        };
        
        // Only clear test contexts, not real contexts
        if (simpleSidekick) {
            try {
                const savedContext = localStorage.getItem('sidekickContext');
                if (savedContext) {
                    const parsedContext = JSON.parse(savedContext);
                    // Only clear if it's a test context
                    if (parsedContext && (parsedContext.topic === 'test' || parsedContext.response === 'test response')) {
                        simpleSidekick.forceClearContext();
                        console.log('Cleared old test context on page load');
                    } else {
                        console.log('Preserved real context on page load:', parsedContext);
                    }
                }
            } catch (error) {
                console.error('Error checking context on page load:', error);
            }
        }
        
        // Update debug logs if panel is visible
        if (document.getElementById('debugPanel').style.display !== 'none') {
            updateDebugLogs();
        }
        console.log('Simple sidekick created:', simpleSidekick);
        
        // Give the knowledge base a moment to load
        setTimeout(() => {
            console.log('Simple sidekick initialized:', simpleSidekick);
            console.log('Knowledge base loaded:', simpleSidekick.knowledgeBase ? 'Yes' : 'No');
            if (simpleSidekick.knowledgeBase) {
                console.log('Knowledge base sections:', Object.keys(simpleSidekick.knowledgeBase));
                
                // Test the simple sidekick
                console.log('Testing simple sidekick...');
                const testResponse = simpleSidekick.getResponse('latest project');
                console.log('Test response for "latest project":', testResponse);
                
                // Test context functionality
                console.log('Testing simple context functionality...');
                // Removed test context setting to avoid interference
                console.log('Context functionality ready');
            } else {
                console.log('Knowledge base not loaded!');
            }
            console.log('=== END INITIALIZATION DEBUG ===');
        }, 1000);
        
        // Wait a moment for knowledge base to load
        setTimeout(() => {
        }, 1000);

        // Ensure chat history persists across navigation
        window.addEventListener('beforeunload', () => {
            // Don't clear chat history on page navigation
        });

        // Mobile-specific scroll function
        function scrollToLatestMessage() {
            const chatMessages = document.getElementById('chat-messages');
            const isMobile = window.innerWidth <= 768;
            const aiSidekick = document.getElementById('ai-sidekick');
            const isMobileFullscreen = aiSidekick && aiSidekick.classList.contains('mobile-fullscreen');
            
            if (isMobile && isMobileFullscreen) {
                // Mobile full-screen: scroll to bottom for normal column layout
                chatMessages.scrollTop = chatMessages.scrollHeight;
            } else {
                // Desktop: scroll to bottom as usual
                chatMessages.scrollTop = chatMessages.scrollHeight;
            }
        }
        
        function addMessage(text, isUser = false, animate = true) {
            const p = document.createElement('p');
            p.className = isUser ? 'text-black' : 'text-[#18a000]';
            if (isUser) {
                p.textContent = `> ${text}`;
            } else if (!animate) {
                // Convert line breaks to HTML br tags for proper formatting
                p.innerHTML = text.replace(/\n/g, '<br>');
            }
            chatMessages.appendChild(p);

            if (!isUser && animate) {
                animateText(p, text);
            }

            scrollToLatestMessage();

            // Save to sessionStorage
            const history = JSON.parse(sessionStorage.getItem('chatHistory')) || [];
            history.push({ text, isUser });
            sessionStorage.setItem('chatHistory', JSON.stringify(history));
        }

        // Typing animation for dots
        function animateTypingDots(element) {
            let dots = 0;
            const interval = setInterval(() => {
                dots = (dots + 1) % 4;
                element.textContent = '.'.repeat(dots);
            }, 500);
            return interval;
        }

        // Text animation character by character
        async function animateText(element, text) {
            let currentText = '';
            const delay = 30; // ms between each character

            for (let i = 0; i < text.length; i++) {
                currentText += text[i];
                // Convert line breaks to HTML br tags for proper formatting
                element.innerHTML = currentText.replace(/\n/g, '<br>');
                
                // Auto-scroll to show new text as it's being typed
                scrollToLatestMessage();
                
                await new Promise(resolve => setTimeout(resolve, delay));
            }
        }

        async function simulateTyping(text, action = null) {
            if (isTyping) return;
            isTyping = true;
            
            const typingIndicator = document.createElement('p');
            typingIndicator.className = 'text-[#18a000] font-mono';
            typingIndicator.textContent = '.';
            chatMessages.appendChild(typingIndicator);

            // Animate typing dots
            const dotsInterval = animateTypingDots(typingIndicator);

            // Wait before starting to type
            await new Promise(resolve => setTimeout(resolve, 1500));
            
            // Clear typing indicator
            clearInterval(dotsInterval);
            chatMessages.removeChild(typingIndicator);
            
            // Add and animate the message
            addMessage(text);
            isTyping = false;

            // Execute navigation action if provided
            if (action) {
                setTimeout(action, 500);
            }
        }

        // Handle chat input
        chatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                const message = chatInput.value.trim();
                if (message && !isTyping) {
                    addMessage(message, true);
                    chatInput.value = '';
                    autoResize();
                    
                    isTyping = true;
                    const typingElement = document.createElement('p');
                    typingElement.className = 'text-[#18a000]';
                    chatMessages.appendChild(typingElement);
                    
                    const typingInterval = animateTypingDots(typingElement);
                    
                    setTimeout(() => {
                        clearInterval(typingInterval);
                        chatMessages.removeChild(typingElement);
                        
                        try {
                            // Handle async findResponse
                            findResponse(message).then(response => {
                                console.log('Response received:', response);
                                
                                if (response && response.text) {
                                    addMessage(response.text, false);
                                    
                                    if (response.action) {
                                        setTimeout(() => {
                                            response.action();
                                        }, 1000);
                                    }
                                } else {
                                    console.error('Invalid response:', response);
                                    addMessage("I'm sorry, I encountered an error processing your request. Please try again.", false);
                                }
                            }).catch(error => {
                                console.error('Error in findResponse:', error);
                                addMessage("I'm sorry, I encountered an error processing your request. Please try again.", false);
                            });
                        } catch (error) {
                            console.error('Error in findResponse:', error);
                            addMessage("I'm sorry, I encountered an error processing your request. Please try again.", false);
                        }
                        
                        isTyping = false;
                    }, 1000);
                }
            }
        });

        // Add click handling for contact dropdown
        document.addEventListener('DOMContentLoaded', () => {
            const contactButton = document.querySelector('.contact-dropdown');
            const contactDropdownMenu = document.querySelector('.contact-dropdown-menu');
            
            if (contactButton && contactDropdownMenu) {
                contactButton.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    // Toggle dropdown visibility
                    const isVisible = contactDropdownMenu.classList.contains('visible');
                    
                    if (isVisible) {
                        contactDropdownMenu.classList.remove('opacity-100', 'visible');
                        contactDropdownMenu.classList.add('opacity-0', 'invisible');
                    } else {
                        contactDropdownMenu.classList.remove('invisible', 'opacity-0');
                        contactDropdownMenu.classList.add('opacity-100', 'visible');
                    }
                });
                
                // Close dropdown when clicking outside
                document.addEventListener('click', (event) => {
                    if (!contactDropdownMenu.contains(event.target) && !contactButton.contains(event.target)) {
                        contactDropdownMenu.classList.remove('opacity-100', 'visible');
                        contactDropdownMenu.classList.add('opacity-0', 'invisible');
                    }
                });
            }
        });

        // Optional: Scroll to sections when AI mentions them
        function scrollToSection(sectionId) {
            const section = document.getElementById(sectionId);
            if (section) {
                section.scrollIntoView({ behavior: 'smooth' });
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            const cursor = document.getElementById('cursor');
            
            // Check if we need to scroll to a specific section
            const scrollToSection = sessionStorage.getItem('scrollToSection');
            if (scrollToSection) {
                console.log('Found scrollToSection:', scrollToSection);
                console.log('Current page:', window.location.pathname);
                console.log('All sections on page:', document.querySelectorAll('section[id]'));
                
                setTimeout(() => {
                    const section = document.getElementById(scrollToSection);
                    console.log('Looking for section with id:', scrollToSection);
                    console.log('Section found:', section);
                    
                    if (section) {
                        console.log('Section found, starting cursor animation');
                        console.log('Section rect:', section.getBoundingClientRect());
                        
                        // Animate cursor to the section
                        const cursor = document.getElementById('cursor');
                        const rect = section.getBoundingClientRect();
                        
                        // Set isNavigating to true to prevent mouse tracking interference
                        isNavigating = true;
                        console.log('isNavigating set to true');
                        
                        // Make cursor visible and start animation
                        cursor.classList.add('navigating');
                        cursor.style.transition = 'all 1s ease';
                        cursor.style.left = (rect.left + rect.width/2) + 'px';
                        cursor.style.top = (rect.top + rect.height/2) + 'px';
                        
                        console.log('Cursor positioned at:', rect.left + rect.width/2, rect.top + rect.height/2);
                        console.log('Cursor classes:', cursor.className);
                        console.log('Cursor style:', cursor.style.cssText);
                        
                        setTimeout(() => {
                            console.log('Starting scroll animation');
                            lastAINavigationPosition = { x: rect.left + rect.width/2, y: rect.top + rect.height/2 };
                            section.scrollIntoView({ behavior: 'smooth' });
                            
                            setTimeout(() => {
                                console.log('Animation complete, transitioning cursor');
                                cursor.style.transition = 'transform 0.2s ease, background-color 0.3s ease';
                                cursor.classList.remove('navigating');
                                transitionCursorFromAI();
                            }, 1000);
                        }, 1000);
                    } else {
                        console.log('Section not found:', scrollToSection);
                        console.log('Available sections:', Array.from(document.querySelectorAll('section[id]')).map(s => s.id));
                    }
                    sessionStorage.removeItem('scrollToSection');
                }, 1000);
            }
            
            // Check if we're coming from a navigation action
            if (sessionStorage.getItem('isNavigating') === 'true') {
                isNavigating = true;
                cursor.classList.add('navigating');
                
                // Position cursor at the projects link position
                const projectsLink = document.querySelector('a[href="projects.html"]');
                if (projectsLink) {
                    const rect = projectsLink.getBoundingClientRect();
                    cursor.style.left = (rect.left + rect.width/2) + 'px';
                    cursor.style.top = (rect.top + rect.height/2) + 'px';
                }
                
                setTimeout(() => {
                    cursor.style.transition = 'transform 0.2s ease, background-color 0.3s ease';
                    cursor.classList.remove('navigating');
                    sessionStorage.removeItem('isNavigating');
                    sessionStorage.removeItem('targetProject'); // Clear targetProject as well
                    transitionCursorFromAI(); // Use smooth transition
                }, 100);
            }

            // Check if we need to navigate to a specific project
            const targetProject = sessionStorage.getItem('targetProject');
            if (targetProject) {
                setTimeout(() => {
                    const targetLink = document.querySelector(`a[href="${targetProject}.html"]`);
                    if (targetLink) {
                        isNavigating = true;
                        cursor.classList.add('navigating');
                        
                        // Scroll to make the target link visible
                        targetLink.scrollIntoView({ 
                            behavior: 'smooth', 
                            block: 'center',
                            inline: 'center'
                        });
                        
                        // Wait for scroll to complete before animating cursor
                        setTimeout(() => {
                            const rect = targetLink.getBoundingClientRect();
                            cursor.style.transition = 'all 1s ease';
                            cursor.style.left = (rect.left + rect.width/2) + 'px';
                            cursor.style.top = (rect.top + rect.height/2) + 'px';
                            
                            setTimeout(() => {
                                // Store the final position before navigation
                                lastAINavigationPosition = {
                                    x: rect.left + rect.width/2,
                                    y: rect.top + rect.height/2
                                };
                                sessionStorage.setItem('isNavigating', 'true');
                                sessionStorage.setItem('targetProject', targetProject);
                                window.location.href = `${targetProject}.html`;
                            }, 1000);
                        }, 800); // Wait for scroll animation
                    }
                    sessionStorage.removeItem('targetProject');
                }, 500);
            }
        });
        
        // Hero Animation Zone Interactions
        document.addEventListener('DOMContentLoaded', function() {
            const heroAnimation = document.getElementById('hero-animation');
            if (!heroAnimation) return;
            
            const zones = heroAnimation.querySelectorAll('[data-zone]');
            const animations = heroAnimation.querySelectorAll('[data-animation]');
            
            let isHovering = false;
            let activeAnimations = new Set();
            
            // Handle mouse enter for the entire hero section
            heroAnimation.addEventListener('mouseenter', () => {
                isHovering = true;
                activeAnimations.clear();
            });
            
            // Handle mouse leave for the entire hero section
            heroAnimation.addEventListener('mouseleave', () => {
                isHovering = false;
                
                // Roll away all animations with staggered timing
                const allAnimations = Array.from(animations);
                allAnimations.forEach((anim, index) => {
                    setTimeout(() => {
                        if (anim.dataset.animation.includes('vertical') || anim.style.transform.includes('scaleY')) {
                            anim.style.transform = 'scaleY(0)';
                        } else {
                            anim.style.transform = 'scaleX(0)';
                        }
                    }, index * 50); // Faster roll away
                });
            });
            
            let mouseX = 0;
            let mouseY = 0;
            let touchX = 0;
            let touchY = 0;
            
            // Track mouse position
            heroAnimation.addEventListener('mousemove', (e) => {
                const rect = heroAnimation.getBoundingClientRect();
                mouseX = e.clientX - rect.left;
                mouseY = e.clientY - rect.top;
            });
            
            // Track touch position for mobile
            heroAnimation.addEventListener('touchstart', (e) => {
                e.preventDefault();
                isHovering = true;
                activeAnimations.clear();
                
                const rect = heroAnimation.getBoundingClientRect();
                const touch = e.touches[0];
                touchX = touch.clientX - rect.left;
                touchY = touch.clientY - rect.top;
                
                // Trigger animation on touch start
                triggerTouchAnimation(touchX, touchY);
            });
            
            // Handle touch end for mobile hover state
            heroAnimation.addEventListener('touchend', () => {
                isHovering = false;
                
                // Roll away all animations with staggered timing
                const allAnimations = Array.from(animations);
                allAnimations.forEach((anim, index) => {
                    setTimeout(() => {
                        if (anim.dataset.animation.includes('vertical') || anim.style.transform.includes('scaleY')) {
                            anim.style.transform = 'scaleY(0)';
                        } else {
                            anim.style.transform = 'scaleX(0)';
                        }
                    }, index * 50); // Faster roll away
                });
            });
            
            heroAnimation.addEventListener('touchmove', (e) => {
                e.preventDefault();
                const rect = heroAnimation.getBoundingClientRect();
                const touch = e.touches[0];
                touchX = touch.clientX - rect.left;
                touchY = touch.clientY - rect.top;
                
                // Trigger animation on touch move (with throttling)
                if (!heroAnimation.touchThrottle) {
                    heroAnimation.touchThrottle = setTimeout(() => {
                        triggerTouchAnimation(touchX, touchY);
                        heroAnimation.touchThrottle = null;
                    }, 100); // Throttle to every 100ms
                }
            });
            
            // Function to trigger animation on touch
            function triggerTouchAnimation(x, y) {
                if (!isHovering) return;
                
                // Get all available animations
                const allAnimations = Array.from(animations);
                const availableAnimations = allAnimations.filter(anim => !activeAnimations.has(anim.dataset.animation));
                
                // Randomly select 1-2 animations to trigger
                const numToTrigger = Math.floor(Math.random() * 2) + 1;
                const selectedAnimations = [];
                
                for (let i = 0; i < numToTrigger && availableAnimations.length > 0; i++) {
                    const randomIndex = Math.floor(Math.random() * availableAnimations.length);
                    const selectedAnim = availableAnimations.splice(randomIndex, 1)[0];
                    selectedAnimations.push(selectedAnim);
                }
                
                // Trigger selected animations
                selectedAnimations.forEach((anim) => {
                    if (!activeAnimations.has(anim.dataset.animation)) {
                        activeAnimations.add(anim.dataset.animation);
                        
                        // Generate random opacity between 0.6 and 1.0
                        const randomOpacity = Math.random() * 0.4 + 0.6;
                        anim.style.opacity = randomOpacity;
                        
                        // Generate random line length scaling between 50% and 150%
                        const randomLengthScale = Math.random() * 1.0 + 0.5;
                        
                        // Apply random length scaling
                        if (anim.dataset.animation.includes('vertical') || anim.style.transform.includes('scaleY')) {
                            const currentHeight = anim.style.height || '33.333%';
                            const newHeight = `calc(${currentHeight} * ${randomLengthScale})`;
                            anim.style.height = newHeight;
                        } else {
                            const currentWidth = anim.style.width || '33.333%';
                            const newWidth = `calc(${currentWidth} * ${randomLengthScale})`;
                            anim.style.width = newWidth;
                        }
                        
                        // Position near touch point but respect text protection zone
                        const rect = heroAnimation.getBoundingClientRect();
                        const minTop = window.innerWidth <= 768 ? 192 : 192; // Text protection zone (restored for mobile)
                        
                        if (anim.dataset.animation.includes('vertical') || anim.style.transform.includes('scaleY')) {
                            const newLeft = Math.max(4, Math.min(rect.width - 20, x - 10));
                            anim.style.left = newLeft + 'px';
                            anim.style.transform = 'scaleY(1)';
                        } else {
                            const newTop = Math.max(minTop, Math.min(rect.height - 20, y - 10));
                            anim.style.top = newTop + 'px';
                            anim.style.transform = 'scaleX(1)';
                        }
                        
                        // Auto-remove after 2-3 seconds
                        setTimeout(() => {
                            if (anim.dataset.animation.includes('vertical') || anim.style.transform.includes('scaleY')) {
                                anim.style.transform = 'scaleY(0)';
                            } else {
                                anim.style.transform = 'scaleX(0)';
                            }
                            activeAnimations.delete(anim.dataset.animation);
                        }, Math.random() * 1000 + 2000); // 2-3 seconds
                    }
                });
            }
            
            zones.forEach(zone => {
                zone.addEventListener('mouseenter', () => {
                    if (!isHovering) return;
                    
                    // Get all available animations
                    const allAnimations = Array.from(animations);
                    const availableAnimations = allAnimations.filter(anim => !activeAnimations.has(anim.dataset.animation));
                    
                    // Randomly select 2-3 animations to trigger
                    const numToTrigger = Math.floor(Math.random() * 2) + 2;
                    const selectedAnimations = [];
                    
                    for (let i = 0; i < numToTrigger && availableAnimations.length > 0; i++) {
                        const randomIndex = Math.floor(Math.random() * availableAnimations.length);
                        const selectedAnim = availableAnimations.splice(randomIndex, 1)[0];
                        selectedAnimations.push(selectedAnim);
                    }
                    
                    // Trigger selected animations with random delays
                    selectedAnimations.forEach((anim, index) => {
                        if (!activeAnimations.has(anim.dataset.animation)) {
                            activeAnimations.add(anim.dataset.animation);
                            const randomDelay = Math.random() * 200 + 100;
                            
                            setTimeout(() => {
                                // Generate random opacity between 0.6 and 1.0
                                const randomOpacity = Math.random() * 0.4 + 0.6;
                                anim.style.opacity = randomOpacity;
                                
                                // Generate random line length scaling between 50% and 150%
                                const randomLengthScale = Math.random() * 1.0 + 0.5;
                                
                                // Apply random length scaling
                                if (anim.dataset.animation.includes('vertical') || anim.style.transform.includes('scaleY')) {
                                    const currentHeight = anim.style.height || '33.333%';
                                    const newHeight = `calc(${currentHeight} * ${randomLengthScale})`;
                                    anim.style.height = newHeight;
                                } else {
                                    const currentWidth = anim.style.width || '33.333%';
                                    const newWidth = `calc(${currentWidth} * ${randomLengthScale})`;
                                    anim.style.width = newWidth;
                                }
                                
                                // Position near cursor but respect text protection zone
                                const rect = heroAnimation.getBoundingClientRect();
                                const minTop = 192; // Text protection zone
                                
                                if (anim.dataset.animation.includes('vertical') || anim.style.transform.includes('scaleY')) {
                                    const newLeft = Math.max(4, Math.min(rect.width - 20, mouseX - 10));
                                    anim.style.left = newLeft + 'px';
                                    anim.style.transform = 'scaleY(1)';
                                } else {
                                    const newTop = Math.max(minTop, Math.min(rect.height - 20, mouseY - 10));
                                    anim.style.top = newTop + 'px';
                                    anim.style.transform = 'scaleX(1)';
                                }
                            }, randomDelay);
                        }
                    });
                });
            });
            
            // Initial random animation on page load
            function triggerInitialAnimation() {
                const rect = heroAnimation.getBoundingClientRect();
                const minTop = window.innerWidth <= 768 ? 192 : 192; // Text protection zone (restored for mobile)
                
                // Get all available animations
                const allAnimations = Array.from(animations);
                
                // Randomly select 5-7 animations to trigger (more prominent on mobile)
                const numToTrigger = Math.floor(Math.random() * 3) + 5;
                const selectedAnimations = [];
                
                for (let i = 0; i < numToTrigger && allAnimations.length > 0; i++) {
                    const randomIndex = Math.floor(Math.random() * allAnimations.length);
                    const selectedAnim = allAnimations.splice(randomIndex, 1)[0];
                    selectedAnimations.push(selectedAnim);
                }
                
                // Trigger selected animations with staggered delays
                selectedAnimations.forEach((anim, index) => {
                    const delay = index * 200 + 100; // Start after 100ms, then every 200ms (faster and earlier)
                    
                    setTimeout(() => {
                        // Generate random opacity between 0.6 and 1.0
                        const randomOpacity = Math.random() * 0.4 + 0.6;
                        anim.style.opacity = randomOpacity;
                        
                        // Generate random line length scaling between 50% and 150%
                        const randomLengthScale = Math.random() * 1.0 + 0.5;
                        
                        // Apply random length scaling
                        if (anim.dataset.animation.includes('vertical') || anim.style.transform.includes('scaleY')) {
                            const currentHeight = anim.style.height || '33.333%';
                            const newHeight = `calc(${currentHeight} * ${randomLengthScale})`;
                            anim.style.height = newHeight;
                        } else {
                            const currentWidth = anim.style.width || '33.333%';
                            const newWidth = `calc(${currentWidth} * ${randomLengthScale})`;
                            anim.style.width = newWidth;
                        }
                        
                        // Position randomly in the animation area (respecting text protection zone)
                        if (anim.dataset.animation.includes('vertical') || anim.style.transform.includes('scaleY')) {
                            const newLeft = Math.max(4, Math.min(rect.width - 20, Math.random() * rect.width));
                            anim.style.left = newLeft + 'px';
                            anim.style.transform = 'scaleY(1)';
                        } else {
                            const newTop = Math.max(minTop, Math.min(rect.height - 20, Math.random() * rect.height));
                            anim.style.top = newTop + 'px';
                            anim.style.transform = 'scaleX(1)';
                        }
                        
                        // Add to active animations
                        activeAnimations.add(anim.dataset.animation);
                        
                        // Auto-remove after 3-5 seconds
                        setTimeout(() => {
                            if (anim.dataset.animation.includes('vertical') || anim.style.transform.includes('scaleY')) {
                                anim.style.transform = 'scaleY(0)';
                            } else {
                                anim.style.transform = 'scaleX(0)';
                            }
                            activeAnimations.delete(anim.dataset.animation);
                        }, Math.random() * 2000 + 3000); // 3-5 seconds
                        
                    }, delay);
                });
            }
            
            // Trigger initial animation immediately to show interactivity
            setTimeout(triggerInitialAnimation, 100);
        });
        
        // Copy email to clipboard function
        function copyEmail() {
            const email = 'c.a.rodriguez1999@gmail.com';
            
            // Use the modern clipboard API if available
            if (navigator.clipboard && window.isSecureContext) {
                navigator.clipboard.writeText(email).then(() => {
                    showEmailPopup();
                }).catch(err => {
                    console.error('Failed to copy: ', err);
                    fallbackCopyEmail(email);
                });
            } else {
                // Fallback for older browsers or non-secure contexts
                fallbackCopyEmail(email);
            }
        }
        
        // Fallback copy method for older browsers
        function fallbackCopyEmail(email) {
            const textArea = document.createElement('textarea');
            textArea.value = email;
            textArea.style.position = 'fixed';
            textArea.style.left = '-999999px';
            textArea.style.top = '-999999px';
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            try {
                document.execCommand('copy');
                showEmailPopup();
            } catch (err) {
                console.error('Fallback copy failed: ', err);
            }
            
            document.body.removeChild(textArea);
        }
        
        // Show email copy popup
        function showEmailPopup() {
            const popup = document.getElementById('email-popup');
            const popupLine = document.getElementById('popup-line');
            
            // Reset any existing timeouts
            if (popup.timeoutId) {
                clearTimeout(popup.timeoutId);
            }
            
            // Show popup with fade-in animation
            popup.style.display = 'block';
            
            // Trigger animation after a brief delay to ensure display is set
            setTimeout(() => {
                popup.style.opacity = '1';
                popup.style.transform = 'translateY(0)';
                
                // Start rolling line animation down as text appears
                setTimeout(() => {
                    popupLine.style.transform = 'scaleY(1)';
                }, 100);
            }, 10);
            
            // Hide popup after 3 seconds
            popup.timeoutId = setTimeout(() => {
                // Start rolling line animation up and fade out popup simultaneously
                popupLine.style.transform = 'scaleY(0)';
                popup.style.opacity = '0';
                popup.style.transform = 'translateY(-10px)';
                
                // Hide completely after fade
                setTimeout(() => {
                    popup.style.display = 'none';
                }, 300);
            }, 3000);
        }
        
                    // Mobile menu functionality
            document.addEventListener('DOMContentLoaded', function() {
                const mobileMenuBtn = document.getElementById('mobile-menu-btn');
                const mobileMenu = document.getElementById('mobile-menu');
                const hamburgerIcon = document.getElementById('hamburger-icon');
                const xIcon = document.getElementById('x-icon');
                
                if (mobileMenuBtn && mobileMenu) {
                    mobileMenuBtn.addEventListener('click', function() {
                        mobileMenu.classList.toggle('hidden');
                        
                        // Toggle icons
                        if (mobileMenu.classList.contains('hidden')) {
                            hamburgerIcon.classList.remove('hidden');
                            xIcon.classList.add('hidden');
                        } else {
                            hamburgerIcon.classList.add('hidden');
                            xIcon.classList.remove('hidden');
                        }
                    });
                }
                
                // Close mobile menu when clicking outside
                document.addEventListener('click', function(event) {
                    if (!mobileMenuBtn.contains(event.target) && !mobileMenu.contains(event.target)) {
                        mobileMenu.classList.add('hidden');
                        hamburgerIcon.classList.remove('hidden');
                        xIcon.classList.add('hidden');
                    }
                });
            
            // Mobile touch support for Featured Projects animations
            const projectCards = document.querySelectorAll('#projects .overflow-hidden');
            
            projectCards.forEach(card => {
                let isAnimating = false;
                
                // Touch start - trigger animation
                card.addEventListener('touchstart', function(e) {
                    if (isAnimating) return;
                    isAnimating = true;
                    
                    // Add hover classes to trigger animation
                    this.classList.add('hover:shadow-2xl', 'hover:scale-105');
                    
                    // Remove classes after animation duration
                    setTimeout(() => {
                        this.classList.remove('hover:shadow-2xl', 'hover:scale-105');
                        isAnimating = false;
                    }, 300); // Match the transition duration
                });
                
                // Allow link to work while keeping animation
                card.addEventListener('touchend', function(e) {
                    // Don't prevent default - allow the link to work
                    // The animation will still play from touchstart
                });
            });
            
                    // Mobile touch support for Blog section animations
        const blogCards = document.querySelectorAll('#blog .overflow-hidden');
        
        blogCards.forEach(card => {
            let isAnimating = false;
            
            // Touch start - trigger animation
            card.addEventListener('touchstart', function(e) {
                if (isAnimating) return;
                isAnimating = true;
                
                // Add hover classes to trigger animation
                this.classList.add('hover:shadow-2xl', 'hover:scale-105');
                
                // Remove classes after animation duration
                setTimeout(() => {
                    this.classList.remove('hover:shadow-2xl', 'hover:scale-105');
                    isAnimating = false;
                }, 300); // Match the transition duration
            });
            
            // Allow link to work while keeping animation
            card.addEventListener('touchend', function(e) {
                // Don't prevent default - allow the link to work
                // The animation will still play from touchstart
            });
        });
    });
    
    // Mobile Contact dropdown toggle function
    function toggleMobileContact() {
        const contactMenu = document.getElementById('mobile-contact-menu');
        const contactLine = document.getElementById('mobile-contact-line');
        
        if (contactMenu.classList.contains('invisible')) {
            // Show dropdown
            contactMenu.classList.remove('invisible', 'opacity-0');
            contactMenu.classList.add('opacity-100');
            contactLine.style.height = '100%';
        } else {
            // Hide dropdown
            contactMenu.classList.add('invisible', 'opacity-0');
            contactMenu.classList.remove('opacity-100');
            contactLine.style.height = '0';
        }
    }
        
        // Disable custom cursor on mobile devices
        function isMobile() {
            return window.innerWidth <= 768;
        }
        
        // Keyboard detection and X button positioning for mobile
        let initialViewportHeight = window.innerHeight;
        let isKeyboardVisible = false;
        
        function updateXButtonPosition() {
            if (!isMobile()) return;
            
            const aiSidekick = document.getElementById('ai-sidekick');
            const sidekickButton = document.getElementById('sidekick-button');
            
            if (!aiSidekick || !sidekickButton || !aiSidekick.classList.contains('mobile-fullscreen')) return;
            
            const currentViewportHeight = window.innerHeight;
            const heightDifference = initialViewportHeight - currentViewportHeight;
            
            console.log('Viewport check:', {
                initial: initialViewportHeight,
                current: currentViewportHeight,
                difference: heightDifference,
                isKeyboardVisible: isKeyboardVisible
            });
            
            // If viewport height decreased significantly, keyboard is likely visible
            if (heightDifference > 100) {
                if (!isKeyboardVisible) {
                    isKeyboardVisible = true;
                    sidekickButton.style.top = '10px';
                    sidekickButton.style.right = '10px';
                    console.log('Keyboard detected, adjusting X button position');
                }
            } else {
                if (isKeyboardVisible) {
                    isKeyboardVisible = false;
                    sidekickButton.style.top = '10px';
                    sidekickButton.style.right = '10px';
                    console.log('Keyboard hidden, resetting X button position');
                }
            }
        }
        
        // Update cursor behavior based on screen size
        function updateCursorBehavior() {
            const cursor = document.getElementById('cursor');
            if (isMobile()) {
                // Hide custom cursor on mobile
                if (cursor) cursor.style.display = 'none';
                // Re-enable default cursor
                document.body.style.cursor = 'auto';
            } else {
                // Show custom cursor on desktop
                if (cursor) cursor.style.display = 'block';
                // Disable default cursor
                document.body.style.cursor = 'none';
            }
        }
        
        // Call on load and resize
        window.addEventListener('load', updateCursorBehavior);
        window.addEventListener('resize', updateCursorBehavior);
        
        // Initialize viewport height and set up keyboard detection
        window.addEventListener('load', function() {
            initialViewportHeight = window.innerHeight;
        });
        
        // Monitor viewport changes for keyboard detection
        window.addEventListener('resize', updateXButtonPosition);
        window.addEventListener('orientationchange', function() {
            // Reset initial height on orientation change
            setTimeout(() => {
                initialViewportHeight = window.innerHeight;
                updateXButtonPosition();
            }, 100);
        });
        
        // Also check when input is focused (keyboard likely to appear)
        document.addEventListener('DOMContentLoaded', function() {
            const chatInput = document.getElementById('chat-input');
            if (chatInput) {
                chatInput.addEventListener('focus', function() {
                    console.log('Input focused, checking for keyboard...');
                    setTimeout(updateXButtonPosition, 300); // Check after keyboard animation
                });
                
                chatInput.addEventListener('blur', function() {
                    console.log('Input blurred, checking for keyboard...');
                    setTimeout(updateXButtonPosition, 300); // Check after keyboard animation
                });
            }
        });
        
        // Periodic check for viewport changes
        setInterval(updateXButtonPosition, 500);
        
        // Handle mobile orientation changes and screen size changes
        window.addEventListener('resize', function() {
            const isMobile = window.innerWidth <= 768;
            const aiSidekick = document.getElementById('ai-sidekick');
            const mainContent = document.getElementById('main-content');
            
            // If switching from mobile to desktop or vice versa, reset sidekick state
            if (aiSidekick && mainContent) {
                if (!isMobile) {
                    // Switching to desktop - ensure mobile classes are removed
                    aiSidekick.classList.remove('mobile-fullscreen');
                    mainContent.classList.remove('mobile-hidden');
                }
            }
        });
        

    </script>

</body>
</html> 